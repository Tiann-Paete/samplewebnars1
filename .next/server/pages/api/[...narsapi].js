"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "pages/api/[...narsapi]";
exports.ids = ["pages/api/[...narsapi]"];
exports.modules = {

/***/ "bcrypt":
/*!*************************!*\
  !*** external "bcrypt" ***!
  \*************************/
/***/ ((module) => {

module.exports = require("bcrypt");

/***/ }),

/***/ "jsonwebtoken":
/*!*******************************!*\
  !*** external "jsonwebtoken" ***!
  \*******************************/
/***/ ((module) => {

module.exports = require("jsonwebtoken");

/***/ }),

/***/ "mysql2/promise":
/*!*********************************!*\
  !*** external "mysql2/promise" ***!
  \*********************************/
/***/ ((module) => {

module.exports = require("mysql2/promise");

/***/ }),

/***/ "next-iron-session":
/*!************************************!*\
  !*** external "next-iron-session" ***!
  \************************************/
/***/ ((module) => {

module.exports = require("next-iron-session");

/***/ }),

/***/ "next/dist/compiled/next-server/pages-api.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/pages-api.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/pages-api.runtime.dev.js");

/***/ }),

/***/ "crypto":
/*!*************************!*\
  !*** external "crypto" ***!
  \*************************/
/***/ ((module) => {

module.exports = require("crypto");

/***/ }),

/***/ "url":
/*!**********************!*\
  !*** external "url" ***!
  \**********************/
/***/ ((module) => {

module.exports = require("url");

/***/ }),

/***/ "(api)/./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2F%5B...narsapi%5D&preferredRegion=&absolutePagePath=.%2Fsrc%5Cpages%5Capi%5C%5B...narsapi%5D.js&middlewareConfigBase64=e30%3D!":
/*!********************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2F%5B...narsapi%5D&preferredRegion=&absolutePagePath=.%2Fsrc%5Cpages%5Capi%5C%5B...narsapi%5D.js&middlewareConfigBase64=e30%3D! ***!
  \********************************************************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   config: () => (/* binding */ config),\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__),\n/* harmony export */   routeModule: () => (/* binding */ routeModule)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/future/route-modules/pages-api/module.compiled */ \"(api)/./node_modules/next/dist/server/future/route-modules/pages-api/module.compiled.js\");\n/* harmony import */ var next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/future/route-kind */ \"(api)/./node_modules/next/dist/server/future/route-kind.js\");\n/* harmony import */ var next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/build/templates/helpers */ \"(api)/./node_modules/next/dist/build/templates/helpers.js\");\n/* harmony import */ var _src_pages_api_narsapi_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./src\\pages\\api\\[...narsapi].js */ \"(api)/./src/pages/api/[...narsapi].js\");\n\n\n\n// Import the userland code.\n\n// Re-export the handler (should be the default export).\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__.hoist)(_src_pages_api_narsapi_js__WEBPACK_IMPORTED_MODULE_3__, \"default\"));\n// Re-export config.\nconst config = (0,next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__.hoist)(_src_pages_api_narsapi_js__WEBPACK_IMPORTED_MODULE_3__, \"config\");\n// Create and export the route module that will be consumed.\nconst routeModule = new next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0__.PagesAPIRouteModule({\n    definition: {\n        kind: next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.PAGES_API,\n        page: \"/api/[...narsapi]\",\n        pathname: \"/api/[...narsapi]\",\n        // The following aren't used in production.\n        bundlePath: \"\",\n        filename: \"\"\n    },\n    userland: _src_pages_api_narsapi_js__WEBPACK_IMPORTED_MODULE_3__\n});\n\n//# sourceMappingURL=pages-api.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaSkvLi9ub2RlX21vZHVsZXMvbmV4dC9kaXN0L2J1aWxkL3dlYnBhY2svbG9hZGVycy9uZXh0LXJvdXRlLWxvYWRlci9pbmRleC5qcz9raW5kPVBBR0VTX0FQSSZwYWdlPSUyRmFwaSUyRiU1Qi4uLm5hcnNhcGklNUQmcHJlZmVycmVkUmVnaW9uPSZhYnNvbHV0ZVBhZ2VQYXRoPS4lMkZzcmMlNUNwYWdlcyU1Q2FwaSU1QyU1Qi4uLm5hcnNhcGklNUQuanMmbWlkZGxld2FyZUNvbmZpZ0Jhc2U2ND1lMzAlM0QhIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7O0FBQXNHO0FBQ3ZDO0FBQ0w7QUFDMUQ7QUFDK0Q7QUFDL0Q7QUFDQSxpRUFBZSx3RUFBSyxDQUFDLHNEQUFRLFlBQVksRUFBQztBQUMxQztBQUNPLGVBQWUsd0VBQUssQ0FBQyxzREFBUTtBQUNwQztBQUNPLHdCQUF3QixnSEFBbUI7QUFDbEQ7QUFDQSxjQUFjLHlFQUFTO0FBQ3ZCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0wsWUFBWTtBQUNaLENBQUM7O0FBRUQiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9uYXJzLz9lNDZmIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IFBhZ2VzQVBJUm91dGVNb2R1bGUgfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9mdXR1cmUvcm91dGUtbW9kdWxlcy9wYWdlcy1hcGkvbW9kdWxlLmNvbXBpbGVkXCI7XG5pbXBvcnQgeyBSb3V0ZUtpbmQgfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9mdXR1cmUvcm91dGUta2luZFwiO1xuaW1wb3J0IHsgaG9pc3QgfSBmcm9tIFwibmV4dC9kaXN0L2J1aWxkL3RlbXBsYXRlcy9oZWxwZXJzXCI7XG4vLyBJbXBvcnQgdGhlIHVzZXJsYW5kIGNvZGUuXG5pbXBvcnQgKiBhcyB1c2VybGFuZCBmcm9tIFwiLi9zcmNcXFxccGFnZXNcXFxcYXBpXFxcXFsuLi5uYXJzYXBpXS5qc1wiO1xuLy8gUmUtZXhwb3J0IHRoZSBoYW5kbGVyIChzaG91bGQgYmUgdGhlIGRlZmF1bHQgZXhwb3J0KS5cbmV4cG9ydCBkZWZhdWx0IGhvaXN0KHVzZXJsYW5kLCBcImRlZmF1bHRcIik7XG4vLyBSZS1leHBvcnQgY29uZmlnLlxuZXhwb3J0IGNvbnN0IGNvbmZpZyA9IGhvaXN0KHVzZXJsYW5kLCBcImNvbmZpZ1wiKTtcbi8vIENyZWF0ZSBhbmQgZXhwb3J0IHRoZSByb3V0ZSBtb2R1bGUgdGhhdCB3aWxsIGJlIGNvbnN1bWVkLlxuZXhwb3J0IGNvbnN0IHJvdXRlTW9kdWxlID0gbmV3IFBhZ2VzQVBJUm91dGVNb2R1bGUoe1xuICAgIGRlZmluaXRpb246IHtcbiAgICAgICAga2luZDogUm91dGVLaW5kLlBBR0VTX0FQSSxcbiAgICAgICAgcGFnZTogXCIvYXBpL1suLi5uYXJzYXBpXVwiLFxuICAgICAgICBwYXRobmFtZTogXCIvYXBpL1suLi5uYXJzYXBpXVwiLFxuICAgICAgICAvLyBUaGUgZm9sbG93aW5nIGFyZW4ndCB1c2VkIGluIHByb2R1Y3Rpb24uXG4gICAgICAgIGJ1bmRsZVBhdGg6IFwiXCIsXG4gICAgICAgIGZpbGVuYW1lOiBcIlwiXG4gICAgfSxcbiAgICB1c2VybGFuZFxufSk7XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPXBhZ2VzLWFwaS5qcy5tYXAiXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(api)/./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2F%5B...narsapi%5D&preferredRegion=&absolutePagePath=.%2Fsrc%5Cpages%5Capi%5C%5B...narsapi%5D.js&middlewareConfigBase64=e30%3D!\n");

/***/ }),

/***/ "(api)/./src/pages/api/[...narsapi].js":
/*!***************************************!*\
  !*** ./src/pages/api/[...narsapi].js ***!
  \***************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\n/* harmony import */ var url__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! url */ \"url\");\n/* harmony import */ var url__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(url__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var bcrypt__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! bcrypt */ \"bcrypt\");\n/* harmony import */ var bcrypt__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(bcrypt__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var jsonwebtoken__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! jsonwebtoken */ \"jsonwebtoken\");\n/* harmony import */ var jsonwebtoken__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(jsonwebtoken__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var _utils_db__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../utils/db */ \"(api)/./src/utils/db.js\");\n/* harmony import */ var crypto__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! crypto */ \"crypto\");\n/* harmony import */ var crypto__WEBPACK_IMPORTED_MODULE_4___default = /*#__PURE__*/__webpack_require__.n(crypto__WEBPACK_IMPORTED_MODULE_4__);\n/* harmony import */ var next_iron_session__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! next-iron-session */ \"next-iron-session\");\n/* harmony import */ var next_iron_session__WEBPACK_IMPORTED_MODULE_5___default = /*#__PURE__*/__webpack_require__.n(next_iron_session__WEBPACK_IMPORTED_MODULE_5__);\n\n\n\n\n\n\nconst handler = async (req, res)=>{\n    const { method } = req;\n    const { pathname } = (0,url__WEBPACK_IMPORTED_MODULE_0__.parse)(req.url, true);\n    try {\n        switch(method){\n            case \"GET\":\n                if (pathname === \"/api/check-auth\") {\n                    handleCheckAuth(req, res);\n                } else if (pathname.startsWith(\"/api/order/\")) {\n                    await handleGetOrder(req, res);\n                } else if (pathname.startsWith(\"/api/order-tracking/\")) {\n                    await handleOrderTracking(req, res);\n                } else if (pathname === \"/api/order-history\") {\n                    await handleOrderHistory(req, res);\n                } else if (pathname === \"/api/all-orders\") {\n                    await handleAllOrders(req, res);\n                } else if (pathname === \"/api/logout\") {\n                    await handleLogout(req, res);\n                } else if (pathname === \"/api/user\") {\n                    handleGetUser(req, res);\n                } else if (pathname === \"/api/products\") {\n                    await handleGetProducts(req, res);\n                } else if (pathname.startsWith(\"/api/products/category/\")) {\n                    const category = pathname.split(\"/\").pop();\n                    await handleGetProductsByCategory(req, res, category);\n                } else if (pathname === \"/api/cart\") {\n                    handleGetCart(req, res);\n                } else if (pathname === \"/api/limited-items\") {\n                    await handleGetLimitedItems(req, res);\n                } else if (pathname === \"/api/categories\") {\n                    await handleGetCategories(req, res);\n                } else if (pathname === \"/api/search\") {\n                    await handleSearch(req, res);\n                } else {\n                    res.status(404).json({\n                        error: \"Not Found\"\n                    });\n                }\n                break;\n            case \"POST\":\n                if (pathname === \"/api/signup\") {\n                    await handleSignup(req, res);\n                } else if (pathname === \"/api/signin\") {\n                    await handleSignin(req, res);\n                } else if (pathname === \"/api/place-order\") {\n                    await handlePlaceOrder(req, res);\n                } else if (pathname.startsWith(\"/api/cancel-order/\")) {\n                    await handleCancelOrder(req, res);\n                } else if (pathname.startsWith(\"/api/submit-ratings/\")) {\n                    await handleSubmitRatings(req, res);\n                } else if (pathname === \"/api/cart/add\") {\n                    handleAddToCart(req, res);\n                }\n                break;\n            case \"PUT\":\n                if (pathname === \"/api/cart/update\") {\n                    handleUpdateCart(req, res);\n                }\n                break;\n            case \"DELETE\":\n                if (pathname.startsWith(\"/api/cart/remove/\")) {\n                    handleRemoveFromCart(req, res);\n                } else if (pathname.startsWith(\"/api/cancel-order/\")) {\n                    await handleCancelOrder(req, res);\n                }\n                break;\n            default:\n                res.setHeader(\"Allow\", [\n                    \"GET\",\n                    \"POST\",\n                    \"PUT\",\n                    \"DELETE\"\n                ]);\n                res.status(405).end(`Method ${method} Not Allowed`);\n        }\n    } catch (error) {\n        console.error(error);\n        res.status(500).json({\n            error: \"An error occurred while processing your request\"\n        });\n    }\n};\n//Signup, Signin and User checking\nasync function handleSignup(req, res) {\n    const { firstname, lastname, address, mobile, email, password } = req.body;\n    try {\n        const existingUser = await (0,_utils_db__WEBPACK_IMPORTED_MODULE_3__.query)(\"SELECT * FROM registered_users WHERE email = ?\", [\n            email\n        ]);\n        if (existingUser.length > 0) {\n            return res.status(400).json({\n                error: \"Email is already in use\"\n            });\n        }\n        const hashedPassword = await bcrypt__WEBPACK_IMPORTED_MODULE_1___default().hash(password, 10);\n        const result = await (0,_utils_db__WEBPACK_IMPORTED_MODULE_3__.query)(\"INSERT INTO registered_users (firstName, lastName, address, contact, email, password) VALUES (?, ?, ?, ?, ?, ?)\", [\n            firstname,\n            lastname,\n            address,\n            mobile,\n            email,\n            hashedPassword\n        ]);\n        await (0,_utils_db__WEBPACK_IMPORTED_MODULE_3__.query)(\"INSERT INTO user_login (user_firstname, user_lastname, contact, email) VALUES (?, ?, ?, ?)\", [\n            firstname,\n            lastname,\n            mobile,\n            email\n        ]);\n        const token = (0,jsonwebtoken__WEBPACK_IMPORTED_MODULE_2__.sign)({\n            userId: result.insertId\n        }, process.env.JWT_SECRET, {\n            expiresIn: \"6h\"\n        });\n        res.status(200).json({\n            message: \"Signup successful\",\n            token\n        });\n    } catch (error) {\n        console.error(\"Signup error:\", error);\n        res.status(500).json({\n            error: \"An error occurred during signup\"\n        });\n    }\n}\nasync function handleSignin(req, res) {\n    const { email, password } = req.body;\n    try {\n        const users = await (0,_utils_db__WEBPACK_IMPORTED_MODULE_3__.query)(\"SELECT * FROM registered_users WHERE email = ?\", [\n            email\n        ]);\n        if (users.length === 0) {\n            return res.status(401).json({\n                success: false,\n                error: \"Invalid email or password\"\n            });\n        }\n        const user = users[0];\n        const match = await bcrypt__WEBPACK_IMPORTED_MODULE_1___default().compare(password, user.password);\n        if (!match) {\n            return res.status(401).json({\n                success: false,\n                error: \"Invalid email or password\"\n            });\n        }\n        const token = (0,jsonwebtoken__WEBPACK_IMPORTED_MODULE_2__.sign)({\n            userId: user.id\n        }, process.env.JWT_SECRET, {\n            expiresIn: \"6h\"\n        });\n        req.session.user = {\n            id: user.id,\n            firstName: user.firstName,\n            email: user.email\n        };\n        await req.session.save();\n        await (0,_utils_db__WEBPACK_IMPORTED_MODULE_3__.query)(\"UPDATE user_login SET logout_time = NULL WHERE email = ?\", [\n            email\n        ]);\n        const loginTime = new Date();\n        await (0,_utils_db__WEBPACK_IMPORTED_MODULE_3__.query)(\"UPDATE user_login SET login_time = ? WHERE email = ?\", [\n            loginTime,\n            email\n        ]);\n        res.setHeader(\"Set-Cookie\", `authToken=${token}; HttpOnly; Path=/; Max-Age=3600; SameSite=Strict${ false ? 0 : \"\"}`);\n        res.status(200).json({\n            success: true,\n            message: \"Signin successful\",\n            token,\n            firstName: user.firstName\n        });\n    } catch (error) {\n        console.error(\"Signin error:\", error);\n        res.status(500).json({\n            success: false,\n            error: \"An error occurred during signin\"\n        });\n    }\n}\nfunction handleCheckAuth(req, res) {\n    const token = req.headers.authorization?.split(\" \")[1];\n    if (!token) {\n        return res.json({\n            isAuthenticated: false\n        });\n    }\n    try {\n        const decoded = (0,jsonwebtoken__WEBPACK_IMPORTED_MODULE_2__.verify)(token, process.env.JWT_SECRET);\n        const userId = decoded.userId;\n        if (req.session.user && req.session.user.id === userId) {\n            res.json({\n                isAuthenticated: true,\n                user: {\n                    id: req.session.user.id,\n                    firstName: req.session.user.firstName,\n                    email: req.session.user.email\n                }\n            });\n        } else {\n            req.session.user = {\n                id: userId\n            };\n            res.json({\n                isAuthenticated: true,\n                user: {\n                    id: userId\n                }\n            });\n        }\n    } catch (error) {\n        console.error(\"Token verification error:\", error);\n        res.json({\n            isAuthenticated: false\n        });\n    }\n}\nfunction handleGetUser(req, res) {\n    const authHeader = req.headers.authorization;\n    const token = authHeader && authHeader.split(\" \")[1];\n    if (!token) {\n        console.log(\"No token provided for /api/user\");\n        return res.status(401).json({\n            success: false,\n            error: \"No token provided\"\n        });\n    }\n    try {\n        const decoded = (0,jsonwebtoken__WEBPACK_IMPORTED_MODULE_2__.verify)(token, process.env.JWT_SECRET);\n        (0,_utils_db__WEBPACK_IMPORTED_MODULE_3__.query)(\"SELECT id, firstName, email FROM registered_users WHERE id = ?\", [\n            decoded.userId\n        ]).then((users)=>{\n            if (users.length === 0) {\n                console.log(`User not found for id: ${decoded.userId}`);\n                return res.status(404).json({\n                    success: false,\n                    error: \"User not found\"\n                });\n            }\n            const user = users[0];\n            res.status(200).json({\n                success: true,\n                firstName: user.firstName,\n                email: user.email\n            });\n        }).catch((error)=>{\n            console.error(\"Database query error:\", error);\n            res.status(500).json({\n                success: false,\n                error: \"Database error\"\n            });\n        });\n    } catch (error) {\n        console.error(\"Get user error:\", error);\n        if (error.name === \"TokenExpiredError\") {\n            return res.status(401).json({\n                success: false,\n                error: \"Token expired\",\n                code: \"TOKEN_EXPIRED\"\n            });\n        }\n        res.status(401).json({\n            success: false,\n            error: \"Invalid token\"\n        });\n    }\n}\nasync function handleLogout(req, res) {\n    try {\n        const userEmail = req.headers[\"user-email\"];\n        console.log(\"Received logout request for user:\", userEmail);\n        if (userEmail) {\n            const logoutTime = new Date();\n            console.log(\"Updating logout time:\", logoutTime);\n            try {\n                const result = await (0,_utils_db__WEBPACK_IMPORTED_MODULE_3__.query)(\"UPDATE user_login SET logout_time = ? WHERE email = ? AND logout_time IS NULL\", [\n                    logoutTime,\n                    userEmail\n                ]);\n                console.log(\"Database update result:\", result);\n                if (result.affectedRows === 0) {\n                    console.log(\"No rows updated. User might not exist in user_login table or already logged out.\");\n                } else {\n                    console.log(\"Logout time updated successfully for user:\", userEmail);\n                }\n            } catch (dbError) {\n                console.error(\"Database error:\", dbError);\n                return res.status(500).json({\n                    success: false,\n                    error: \"Database error during logout\"\n                });\n            }\n        } else {\n            console.log(\"No user email provided in request headers\");\n            return res.status(400).json({\n                success: false,\n                error: \"User email not provided\"\n            });\n        }\n        res.setHeader(\"Set-Cookie\", \"authToken=; HttpOnly; Path=/; Max-Age=0; SameSite=Strict\");\n        res.status(200).json({\n            success: true,\n            message: \"Logout successful\"\n        });\n    } catch (error) {\n        console.error(\"Logout error:\", error);\n        res.status(500).json({\n            success: false,\n            error: \"An error occurred during logout\"\n        });\n    }\n}\n//Showing the Products\nasync function handleSearch(req, res) {\n    const { query: searchQuery } = (0,url__WEBPACK_IMPORTED_MODULE_0__.parse)(req.url, true).query;\n    if (!searchQuery) {\n        return res.status(400).json({\n            error: \"Search query is required\"\n        });\n    }\n    try {\n        const searchTerms = searchQuery.split(/\\s+/).map((term)=>`%${term}%`);\n        const placeholders = searchTerms.map(()=>\"(p.name LIKE ? OR p.category LIKE ?)\").join(\" AND \");\n        const sql = `\r\n      SELECT p.*, \r\n             COALESCE(AVG(pr.rating), 5) as avg_rating,\r\n             COUNT(pr.id) as rating_count,\r\n             COALESCE(ps.quantity, 0) as stock_quantity\r\n      FROM products p\r\n      LEFT JOIN product_ratings pr ON p.id = pr.product_id\r\n      LEFT JOIN product_stocks ps ON p.id = ps.product_id\r\n      WHERE p.deleted = 0 AND (${placeholders})\r\n      GROUP BY p.id\r\n    `;\n        const params = searchTerms.flatMap((term)=>[\n                term,\n                term\n            ]);\n        const results = await (0,_utils_db__WEBPACK_IMPORTED_MODULE_3__.query)(sql, params);\n        res.status(200).json(results);\n    } catch (error) {\n        console.error(\"Error searching products:\", error);\n        res.status(500).json({\n            error: \"An error occurred while searching products\",\n            details: error.message\n        });\n    }\n}\nasync function handleGetProducts(req, res) {\n    try {\n        const productsQuery = `\r\n      SELECT p.*, \r\n             COALESCE(AVG(pr.rating), 5) as avg_rating,\r\n             COUNT(pr.id) as rating_count,\r\n             COALESCE(ps.quantity, 0) as stock_quantity\r\n      FROM products p\r\n      LEFT JOIN product_ratings pr ON p.id = pr.product_id\r\n      LEFT JOIN product_stocks ps ON p.id = ps.product_id\r\n      WHERE p.deleted = 0\r\n      GROUP BY p.id\r\n    `;\n        const products = await (0,_utils_db__WEBPACK_IMPORTED_MODULE_3__.query)(productsQuery);\n        res.status(200).json(products);\n    } catch (error) {\n        console.error(\"Error fetching products:\", error);\n        res.status(500).json({\n            error: \"An error occurred while fetching products\",\n            details: error.message\n        });\n    }\n}\nasync function handleGetProductsByCategory(req, res, category) {\n    try {\n        const decodedCategory = decodeURIComponent(category);\n        console.log(`Attempting to fetch products for category: ${decodedCategory}`);\n        const productsQuery = `\r\n      SELECT p.*, \r\n             COALESCE(AVG(pr.rating), 5) as avg_rating,\r\n             COUNT(pr.id) as rating_count,\r\n             COALESCE(ps.quantity, 0) as stock_quantity\r\n      FROM products p\r\n      LEFT JOIN product_ratings pr ON p.id = pr.product_id\r\n      LEFT JOIN product_stocks ps ON p.id = ps.product_id\r\n      WHERE p.category = ? AND p.deleted = 0\r\n      GROUP BY p.id\r\n    `;\n        const products = await (0,_utils_db__WEBPACK_IMPORTED_MODULE_3__.query)(productsQuery, [\n            decodedCategory\n        ]);\n        console.log(`Fetched ${products.length} products for category: ${decodedCategory}`);\n        res.status(200).json(products);\n    } catch (error) {\n        console.error(\"Error fetching products by category:\", error);\n        res.status(500).json({\n            error: \"An error occurred while fetching products by category\",\n            details: error.message,\n            stack: error.stack\n        });\n    }\n}\nasync function handleGetLimitedItems(req, res) {\n    try {\n        console.log(\"Attempting to fetch limited items\");\n        const limitedItemsQuery = `\r\n      SELECT p.*, \r\n             COALESCE(AVG(pr.rating), 5) as avg_rating,\r\n             COUNT(pr.id) as rating_count,\r\n             COALESCE(ps.quantity, 0) as stock_quantity\r\n      FROM products p\r\n      LEFT JOIN product_ratings pr ON p.id = pr.product_id\r\n      LEFT JOIN product_stocks ps ON p.id = ps.product_id\r\n      WHERE p.category = 'Limited Items' AND p.deleted = 0\r\n      GROUP BY p.id\r\n    `;\n        const limitedItems = await (0,_utils_db__WEBPACK_IMPORTED_MODULE_3__.query)(limitedItemsQuery);\n        console.log(\"Query result:\", limitedItems);\n        res.status(200).json(limitedItems);\n    } catch (error) {\n        console.error(\"Error fetching limited items:\", error);\n        res.status(500).json({\n            error: \"An error occurred while fetching limited items\",\n            details: error.message,\n            stack: error.stack\n        });\n    }\n}\nasync function handleGetCategories(req, res) {\n    try {\n        const categories = await (0,_utils_db__WEBPACK_IMPORTED_MODULE_3__.query)(`\r\n        SELECT DISTINCT category \r\n        FROM products \r\n        WHERE deleted = 0 AND category != 'Limited'\r\n      `);\n        const formattedCategories = categories.map((item)=>({\n                id: item.category,\n                name: item.category\n            }));\n        res.status(200).json(formattedCategories);\n    } catch (error) {\n        console.error(\"Error fetching categories:\", error);\n        res.status(500).json({\n            error: \"An error occurred while fetching categories\",\n            details: error.message\n        });\n    }\n}\n//Placing or Checkout an Order\nasync function handlePlaceOrder(req, res) {\n    const authHeader = req.headers.authorization;\n    if (!authHeader) {\n        console.log(\"No Authorization header found\");\n        return res.status(401).json({\n            error: \"No token provided\"\n        });\n    }\n    const token = authHeader.split(\" \")[1];\n    if (!token) {\n        console.log(\"Token not found in Authorization header\");\n        return res.status(401).json({\n            error: \"No token provided\"\n        });\n    }\n    try {\n        const decoded = (0,jsonwebtoken__WEBPACK_IMPORTED_MODULE_2__.verify)(token, process.env.JWT_SECRET);\n        const userId = decoded.userId;\n        const { billingInfo, paymentMethod, cartItems, subtotal, delivery, total } = req.body;\n        const trackingNumber = crypto__WEBPACK_IMPORTED_MODULE_4___default().randomBytes(8).toString(\"hex\").toUpperCase();\n        await (0,_utils_db__WEBPACK_IMPORTED_MODULE_3__.query)(\"START TRANSACTION\");\n        // Insert the order\n        const orderResult = await (0,_utils_db__WEBPACK_IMPORTED_MODULE_3__.query)(\"INSERT INTO orders (user_id, full_name, phone_number, address, city, state_province, postal_code, delivery_address, payment_method, subtotal, delivery_fee, total, tracking_number, status) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)\", [\n            userId,\n            billingInfo.fullName,\n            billingInfo.phoneNumber,\n            billingInfo.address,\n            billingInfo.city,\n            billingInfo.stateProvince,\n            billingInfo.postalCode,\n            billingInfo.deliveryAddress,\n            paymentMethod,\n            subtotal,\n            delivery,\n            total,\n            trackingNumber,\n            \"Order Placed\"\n        ]);\n        const orderId = orderResult.insertId;\n        // Insert ordered products and update stock quantity\n        for (const item of cartItems){\n            // Check if there's enough stock before placing the order\n            const [stockRecord] = await (0,_utils_db__WEBPACK_IMPORTED_MODULE_3__.query)(\"SELECT quantity FROM product_stocks WHERE product_id = ?\", [\n                item.id\n            ]);\n            if (!stockRecord || stockRecord.quantity < item.quantity) {\n                await (0,_utils_db__WEBPACK_IMPORTED_MODULE_3__.query)(\"ROLLBACK\");\n                return res.status(400).json({\n                    error: `Not enough stock for product: ${item.name}`\n                });\n            }\n            await (0,_utils_db__WEBPACK_IMPORTED_MODULE_3__.query)(\"INSERT INTO ordered_products (name, product_id, order_id, quantity, price) VALUES (?, ?, ?, ?, ?)\", [\n                item.name,\n                item.id,\n                orderId,\n                item.quantity,\n                item.price\n            ]);\n            // Update stock quantity in product_stocks table\n            const updateResult = await (0,_utils_db__WEBPACK_IMPORTED_MODULE_3__.query)(\"UPDATE product_stocks SET quantity = quantity - ? WHERE product_id = ?\", [\n                item.quantity,\n                item.id\n            ]);\n            if (updateResult.affectedRows === 0) {\n                await (0,_utils_db__WEBPACK_IMPORTED_MODULE_3__.query)(\"ROLLBACK\");\n                return res.status(400).json({\n                    error: `Not enough stock for product: ${item.name}`\n                });\n            }\n        }\n        await (0,_utils_db__WEBPACK_IMPORTED_MODULE_3__.query)(\"COMMIT\");\n        res.json({\n            success: true,\n            orderId,\n            trackingNumber\n        });\n    } catch (error) {\n        await (0,_utils_db__WEBPACK_IMPORTED_MODULE_3__.query)(\"ROLLBACK\");\n        console.error(\"Error placing order:\", error);\n        if (error.name === \"JsonWebTokenError\") {\n            return res.status(401).json({\n                error: \"Invalid token\"\n            });\n        }\n        res.status(500).json({\n            error: \"An error occurred while placing the order\"\n        });\n    }\n}\n//Order Tracking after Checkout or Placing an Order\nasync function handleGetOrder(req, res) {\n    const authHeader = req.headers.authorization;\n    if (!authHeader) {\n        return res.status(401).json({\n            error: \"No token provided\"\n        });\n    }\n    const token = authHeader.split(\" \")[1];\n    if (!token) {\n        return res.status(401).json({\n            error: \"No token provided\"\n        });\n    }\n    try {\n        const decoded = (0,jsonwebtoken__WEBPACK_IMPORTED_MODULE_2__.verify)(token, process.env.JWT_SECRET);\n        const userId = decoded.userId;\n        const orderId = req.query.orderId || req.url.split(\"/\").pop();\n        const results = await (0,_utils_db__WEBPACK_IMPORTED_MODULE_3__.query)(`\r\n      SELECT o.*, op.name, op.product_id, op.quantity, op.price, p.image_url\r\n      FROM orders o\r\n      JOIN ordered_products op ON o.id = op.order_id\r\n      JOIN products p ON op.product_id = p.id\r\n      WHERE o.id = ? AND o.user_id = ?\r\n    `, [\n            orderId,\n            userId\n        ]);\n        if (results.length === 0) {\n            return res.status(404).json({\n                error: \"Order not found\"\n            });\n        }\n        const orderDetails = {\n            orderId: results[0].id,\n            trackingNumber: results[0].tracking_number,\n            status: results[0].status,\n            billingInfo: {\n                fullName: results[0].full_name,\n                phoneNumber: results[0].phone_number,\n                address: results[0].address,\n                city: results[0].city,\n                stateProvince: results[0].state_province,\n                postalCode: results[0].postal_code,\n                deliveryAddress: results[0].delivery_address\n            },\n            paymentMethod: results[0].payment_method,\n            items: results.map((item)=>({\n                    id: item.product_id,\n                    name: item.name,\n                    quantity: item.quantity,\n                    price: item.price,\n                    imageUrl: item.image_url\n                })),\n            subtotal: results[0].subtotal,\n            delivery: results[0].delivery_fee,\n            total: results[0].total\n        };\n        res.json(orderDetails);\n    } catch (error) {\n        console.error(\"Error fetching order details:\", error);\n        if (error.name === \"JsonWebTokenError\") {\n            return res.status(401).json({\n                error: \"Invalid token\"\n            });\n        }\n        res.status(500).json({\n            error: \"An error occurred while fetching order details\"\n        });\n    }\n}\n//Order History\nasync function handleAllOrders(req, res) {\n    const authHeader = req.headers.authorization;\n    if (!authHeader) {\n        return res.status(401).json({\n            error: \"No token provided\"\n        });\n    }\n    const token = authHeader.split(\" \")[1];\n    if (!token) {\n        return res.status(401).json({\n            error: \"No token provided\"\n        });\n    }\n    try {\n        const decoded = (0,jsonwebtoken__WEBPACK_IMPORTED_MODULE_2__.verify)(token, process.env.JWT_SECRET);\n        const userId = decoded.userId;\n        const orders = await (0,_utils_db__WEBPACK_IMPORTED_MODULE_3__.query)(`\r\n      SELECT id, tracking_number, status, order_date, total\r\n      FROM orders\r\n      WHERE user_id = ?\r\n      ORDER BY order_date DESC\r\n    `, [\n            userId\n        ]);\n        res.status(200).json(orders);\n    } catch (error) {\n        if (error.name === \"JsonWebTokenError\") {\n            return res.status(401).json({\n                error: \"Invalid token\"\n            });\n        }\n        console.error(\"Error fetching all orders:\", error);\n        res.status(500).json({\n            error: \"An error occurred while fetching orders\",\n            details: error.message\n        });\n    }\n}\nasync function handleCancelOrder(req, res) {\n    const authHeader = req.headers.authorization;\n    if (!authHeader) {\n        return res.status(401).json({\n            error: \"No token provided\"\n        });\n    }\n    const token = authHeader.split(\" \")[1];\n    if (!token) {\n        return res.status(401).json({\n            error: \"No token provided\"\n        });\n    }\n    try {\n        const decoded = (0,jsonwebtoken__WEBPACK_IMPORTED_MODULE_2__.verify)(token, process.env.JWT_SECRET);\n        const userId = decoded.userId;\n        const orderId = req.url.split(\"/\").pop();\n        const result = await (0,_utils_db__WEBPACK_IMPORTED_MODULE_3__.query)(`\r\n      UPDATE orders\r\n      SET status = 'Cancelled'\r\n      WHERE id = ? AND user_id = ? AND status = 'Order Placed'\r\n    `, [\n            orderId,\n            userId\n        ]);\n        if (result.affectedRows === 0) {\n            return res.status(400).json({\n                error: \"Order not found or cannot be cancelled\"\n            });\n        }\n        res.json({\n            success: true,\n            message: \"Order cancelled successfully\"\n        });\n    } catch (error) {\n        if (error.name === \"JsonWebTokenError\") {\n            return res.status(401).json({\n                error: \"Invalid token\"\n            });\n        }\n        console.error(\"Error cancelling order:\", error);\n        res.status(500).json({\n            error: \"An error occurred while cancelling the order\"\n        });\n    }\n}\nasync function handleOrderHistory(req, res) {\n    const authHeader = req.headers.authorization;\n    if (!authHeader) {\n        return res.status(401).json({\n            error: \"No token provided\"\n        });\n    }\n    const token = authHeader.split(\" \")[1];\n    if (!token) {\n        return res.status(401).json({\n            error: \"No token provided\"\n        });\n    }\n    try {\n        const decoded = (0,jsonwebtoken__WEBPACK_IMPORTED_MODULE_2__.verify)(token, process.env.JWT_SECRET);\n        const userId = decoded.userId;\n        const orders = await (0,_utils_db__WEBPACK_IMPORTED_MODULE_3__.query)(`\r\n      SELECT o.id, o.tracking_number, o.status, o.order_date, o.total, o.is_rated,\r\n             GROUP_CONCAT(op.name SEPARATOR ', ') AS products\r\n      FROM orders o\r\n      JOIN ordered_products op ON o.id = op.order_id\r\n      WHERE o.user_id = ?\r\n      GROUP BY o.id\r\n      ORDER BY o.order_date DESC\r\n    `, [\n            userId\n        ]);\n        res.status(200).json(orders);\n    } catch (error) {\n        if (error.name === \"JsonWebTokenError\") {\n            return res.status(401).json({\n                error: \"Invalid token\"\n            });\n        }\n        console.error(\"Error fetching order history:\", error);\n        res.status(500).json({\n            error: \"An error occurred while fetching order history\",\n            details: error.message\n        });\n    }\n}\nasync function handleSubmitRatings(req, res) {\n    const authHeader = req.headers.authorization;\n    if (!authHeader) {\n        return res.status(401).json({\n            error: \"No token provided\"\n        });\n    }\n    const token = authHeader.split(\" \")[1];\n    if (!token) {\n        return res.status(401).json({\n            error: \"No token provided\"\n        });\n    }\n    try {\n        const decoded = (0,jsonwebtoken__WEBPACK_IMPORTED_MODULE_2__.verify)(token, process.env.JWT_SECRET);\n        const userId = decoded.userId;\n        const orderId = req.url.split(\"/\").pop();\n        const { ratings, feedback } = req.body;\n        // Verify that the order belongs to the user\n        const orderCheck = await (0,_utils_db__WEBPACK_IMPORTED_MODULE_3__.query)(\"SELECT id FROM orders WHERE id = ? AND user_id = ?\", [\n            orderId,\n            userId\n        ]);\n        if (orderCheck.length === 0) {\n            return res.status(403).json({\n                error: \"Unauthorized to rate this order\"\n            });\n        }\n        // Start a transaction\n        await (0,_utils_db__WEBPACK_IMPORTED_MODULE_3__.query)(\"START TRANSACTION\");\n        try {\n            // Insert ratings for each product\n            for (const [productId, rating] of Object.entries(ratings)){\n                await (0,_utils_db__WEBPACK_IMPORTED_MODULE_3__.query)(\"INSERT INTO product_ratings (order_id, product_id, rating) VALUES (?, ?, ?)\", [\n                    orderId,\n                    productId,\n                    rating\n                ]);\n            }\n            // Insert feedback\n            if (feedback) {\n                await (0,_utils_db__WEBPACK_IMPORTED_MODULE_3__.query)(\"INSERT INTO order_feedback (order_id, feedback) VALUES (?, ?)\", [\n                    orderId,\n                    feedback\n                ]);\n            }\n            // Update the order to mark it as rated\n            await (0,_utils_db__WEBPACK_IMPORTED_MODULE_3__.query)(\"UPDATE orders SET is_rated = 1 WHERE id = ?\", [\n                orderId\n            ]);\n            // Commit the transaction\n            await (0,_utils_db__WEBPACK_IMPORTED_MODULE_3__.query)(\"COMMIT\");\n            res.status(200).json({\n                success: true,\n                message: \"Ratings submitted successfully\"\n            });\n        } catch (error) {\n            // If there's an error, rollback the transaction\n            await (0,_utils_db__WEBPACK_IMPORTED_MODULE_3__.query)(\"ROLLBACK\");\n            throw error;\n        }\n    } catch (error) {\n        if (error.name === \"JsonWebTokenError\") {\n            return res.status(401).json({\n                error: \"Invalid token\"\n            });\n        }\n        console.error(\"Error submitting ratings:\", error);\n        res.status(500).json({\n            error: \"An error occurred while submitting ratings\",\n            details: error.message\n        });\n    }\n}\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,next_iron_session__WEBPACK_IMPORTED_MODULE_5__.withIronSession)(handler, {\n    password: process.env.SESSION_PASSWORD,\n    cookieName: \"nars_session\",\n    cookieOptions: {\n        secure: \"development\" === \"production\",\n        sameSite: \"strict\",\n        httpOnly: true\n    }\n}));\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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WTtJQUNaQyxlQUFlO1FBQ2JDLFFBQVFqRyxrQkFBeUI7UUFDakNrRyxVQUFVO1FBQ1ZDLFVBQVU7SUFDWjtBQUNGLEVBQUUsRUFBQyIsInNvdXJjZXMiOlsid2VicGFjazovL25hcnMvLi9zcmMvcGFnZXMvYXBpL1suLi5uYXJzYXBpXS5qcz83MjQ2Il0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IHBhcnNlIH0gZnJvbSAndXJsJztcclxuaW1wb3J0IGJjcnlwdCBmcm9tICdiY3J5cHQnO1xyXG5pbXBvcnQgeyBzaWduLCB2ZXJpZnkgfSBmcm9tICdqc29ud2VidG9rZW4nO1xyXG5pbXBvcnQgeyBxdWVyeSB9IGZyb20gJy4uLy4uL3V0aWxzL2RiJztcclxuaW1wb3J0IGNyeXB0byBmcm9tICdjcnlwdG8nO1xyXG5pbXBvcnQgeyB3aXRoSXJvblNlc3Npb24gfSBmcm9tICduZXh0LWlyb24tc2Vzc2lvbic7XHJcblxyXG5jb25zdCBoYW5kbGVyID0gYXN5bmMgKHJlcSwgcmVzKSA9PiB7XHJcbiAgICBjb25zdCB7IG1ldGhvZCB9ID0gcmVxO1xyXG4gICAgY29uc3QgeyBwYXRobmFtZSB9ID0gcGFyc2UocmVxLnVybCwgdHJ1ZSk7XHJcblxyXG4gICAgdHJ5IHtcclxuICAgICAgc3dpdGNoIChtZXRob2QpIHtcclxuICAgICAgICBjYXNlICdHRVQnOlxyXG4gICAgICAgICAgaWYgKHBhdGhuYW1lID09PSAnL2FwaS9jaGVjay1hdXRoJykge1xyXG4gICAgICAgICAgICBoYW5kbGVDaGVja0F1dGgocmVxLCByZXMpO1xyXG4gICAgICAgICAgfSBlbHNlIGlmIChwYXRobmFtZS5zdGFydHNXaXRoKCcvYXBpL29yZGVyLycpKSB7XHJcbiAgICAgICAgICAgIGF3YWl0IGhhbmRsZUdldE9yZGVyKHJlcSwgcmVzKTtcclxuICAgICAgICAgIH0gZWxzZSBpZiAocGF0aG5hbWUuc3RhcnRzV2l0aCgnL2FwaS9vcmRlci10cmFja2luZy8nKSkge1xyXG4gICAgICAgICAgICBhd2FpdCBoYW5kbGVPcmRlclRyYWNraW5nKHJlcSwgcmVzKTtcclxuICAgICAgICAgIH0gZWxzZSBpZiAocGF0aG5hbWUgPT09ICcvYXBpL29yZGVyLWhpc3RvcnknKSB7XHJcbiAgICAgICAgICAgIGF3YWl0IGhhbmRsZU9yZGVySGlzdG9yeShyZXEsIHJlcyk7XHJcbiAgICAgICAgICB9IGVsc2UgaWYgKHBhdGhuYW1lID09PSAnL2FwaS9hbGwtb3JkZXJzJykge1xyXG4gICAgICAgICAgICBhd2FpdCBoYW5kbGVBbGxPcmRlcnMocmVxLCByZXMpO1xyXG4gICAgICAgICAgfSBlbHNlIGlmIChwYXRobmFtZSA9PT0gJy9hcGkvbG9nb3V0Jykge1xyXG4gICAgICAgICAgICBhd2FpdCBoYW5kbGVMb2dvdXQocmVxLCByZXMpO1xyXG4gICAgICAgICAgfSBlbHNlIGlmIChwYXRobmFtZSA9PT0gJy9hcGkvdXNlcicpIHtcclxuICAgICAgICAgICAgaGFuZGxlR2V0VXNlcihyZXEsIHJlcyk7XHJcbiAgICAgICAgICB9IGVsc2UgaWYgKHBhdGhuYW1lID09PSAnL2FwaS9wcm9kdWN0cycpIHtcclxuICAgICAgICAgICAgYXdhaXQgaGFuZGxlR2V0UHJvZHVjdHMocmVxLCByZXMpO1xyXG4gICAgICAgICAgfSBlbHNlIGlmIChwYXRobmFtZS5zdGFydHNXaXRoKCcvYXBpL3Byb2R1Y3RzL2NhdGVnb3J5LycpKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IGNhdGVnb3J5ID0gcGF0aG5hbWUuc3BsaXQoJy8nKS5wb3AoKTtcclxuICAgICAgICAgICAgYXdhaXQgaGFuZGxlR2V0UHJvZHVjdHNCeUNhdGVnb3J5KHJlcSwgcmVzLCBjYXRlZ29yeSk7XHJcbiAgICAgICAgICB9IGVsc2UgaWYgKHBhdGhuYW1lID09PSAnL2FwaS9jYXJ0Jykge1xyXG4gICAgICAgICAgICBoYW5kbGVHZXRDYXJ0KHJlcSwgcmVzKTtcclxuICAgICAgICAgIH0gZWxzZSBpZiAocGF0aG5hbWUgPT09ICcvYXBpL2xpbWl0ZWQtaXRlbXMnKSB7XHJcbiAgICAgICAgICAgIGF3YWl0IGhhbmRsZUdldExpbWl0ZWRJdGVtcyhyZXEsIHJlcyk7XHJcbiAgICAgICAgICB9IGVsc2UgaWYgKHBhdGhuYW1lID09PSAnL2FwaS9jYXRlZ29yaWVzJykge1xyXG4gICAgICAgICAgICBhd2FpdCBoYW5kbGVHZXRDYXRlZ29yaWVzKHJlcSwgcmVzKTtcclxuICAgICAgICAgIH0gZWxzZSBpZiAocGF0aG5hbWUgPT09ICcvYXBpL3NlYXJjaCcpIHtcclxuICAgICAgICAgICAgYXdhaXQgaGFuZGxlU2VhcmNoKHJlcSwgcmVzKTtcclxuICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIHJlcy5zdGF0dXMoNDA0KS5qc29uKHsgZXJyb3I6ICdOb3QgRm91bmQnIH0pO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgICAgYnJlYWs7XHJcbiAgICBcclxuICAgICAgICAgIGNhc2UgJ1BPU1QnOlxyXG4gICAgICAgICAgICBpZiAocGF0aG5hbWUgPT09ICcvYXBpL3NpZ251cCcpIHtcclxuICAgICAgICAgICAgICBhd2FpdCBoYW5kbGVTaWdudXAocmVxLCByZXMpO1xyXG4gICAgICAgICAgICB9IGVsc2UgaWYgKHBhdGhuYW1lID09PSAnL2FwaS9zaWduaW4nKSB7XHJcbiAgICAgICAgICAgICAgYXdhaXQgaGFuZGxlU2lnbmluKHJlcSwgcmVzKTtcclxuICAgICAgICAgICAgfSBlbHNlIGlmIChwYXRobmFtZSA9PT0gJy9hcGkvcGxhY2Utb3JkZXInKSB7XHJcbiAgICAgICAgICAgICAgYXdhaXQgaGFuZGxlUGxhY2VPcmRlcihyZXEsIHJlcyk7XHJcbiAgICAgICAgICAgIH0gIGVsc2UgaWYgKHBhdGhuYW1lLnN0YXJ0c1dpdGgoJy9hcGkvY2FuY2VsLW9yZGVyLycpKSB7XHJcbiAgICAgICAgICAgICAgICBhd2FpdCBoYW5kbGVDYW5jZWxPcmRlcihyZXEsIHJlcyk7XHJcbiAgICAgICAgICAgIH0gZWxzZSBpZiAocGF0aG5hbWUuc3RhcnRzV2l0aCgnL2FwaS9zdWJtaXQtcmF0aW5ncy8nKSkge1xyXG4gICAgICAgICAgICAgIGF3YWl0IGhhbmRsZVN1Ym1pdFJhdGluZ3MocmVxLCByZXMpO1xyXG4gICAgICAgICAgICB9IGVsc2UgaWYgKHBhdGhuYW1lID09PSAnL2FwaS9jYXJ0L2FkZCcpIHtcclxuICAgICAgICAgICAgICBoYW5kbGVBZGRUb0NhcnQocmVxLCByZXMpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgXHJcbiAgICAgICAgICBjYXNlICdQVVQnOlxyXG4gICAgICAgICAgICBpZiAocGF0aG5hbWUgPT09ICcvYXBpL2NhcnQvdXBkYXRlJykge1xyXG4gICAgICAgICAgICAgIGhhbmRsZVVwZGF0ZUNhcnQocmVxLCByZXMpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgXHJcbiAgICAgICAgICBjYXNlICdERUxFVEUnOlxyXG4gICAgICAgICAgICBpZiAocGF0aG5hbWUuc3RhcnRzV2l0aCgnL2FwaS9jYXJ0L3JlbW92ZS8nKSkge1xyXG4gICAgICAgICAgICAgIGhhbmRsZVJlbW92ZUZyb21DYXJ0KHJlcSwgcmVzKTtcclxuICAgICAgICAgICAgfSBlbHNlIGlmIChwYXRobmFtZS5zdGFydHNXaXRoKCcvYXBpL2NhbmNlbC1vcmRlci8nKSkge1xyXG4gICAgICAgICAgICAgIGF3YWl0IGhhbmRsZUNhbmNlbE9yZGVyKHJlcSwgcmVzKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBicmVhaztcclxuICAgIFxyXG4gICAgICAgICAgZGVmYXVsdDpcclxuICAgICAgICAgICAgcmVzLnNldEhlYWRlcignQWxsb3cnLCBbJ0dFVCcsICdQT1NUJywgJ1BVVCcsICdERUxFVEUnXSk7XHJcbiAgICAgICAgICAgIHJlcy5zdGF0dXMoNDA1KS5lbmQoYE1ldGhvZCAke21ldGhvZH0gTm90IEFsbG93ZWRgKTtcclxuICAgICAgICB9XHJcbiAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcihlcnJvcik7XHJcbiAgICAgICAgcmVzLnN0YXR1cyg1MDApLmpzb24oeyBlcnJvcjogJ0FuIGVycm9yIG9jY3VycmVkIHdoaWxlIHByb2Nlc3NpbmcgeW91ciByZXF1ZXN0JyB9KTtcclxuICAgICAgfVxyXG4gICAgfVxyXG5cclxuXHJcbiAgICBcclxuLy9TaWdudXAsIFNpZ25pbiBhbmQgVXNlciBjaGVja2luZ1xyXG5hc3luYyBmdW5jdGlvbiBoYW5kbGVTaWdudXAocmVxLCByZXMpIHtcclxuICBjb25zdCB7IGZpcnN0bmFtZSwgbGFzdG5hbWUsIGFkZHJlc3MsIG1vYmlsZSwgZW1haWwsIHBhc3N3b3JkIH0gPSByZXEuYm9keTtcclxuXHJcbiAgdHJ5IHtcclxuICAgIGNvbnN0IGV4aXN0aW5nVXNlciA9IGF3YWl0IHF1ZXJ5KCdTRUxFQ1QgKiBGUk9NIHJlZ2lzdGVyZWRfdXNlcnMgV0hFUkUgZW1haWwgPSA/JywgW2VtYWlsXSk7XHJcbiAgICBpZiAoZXhpc3RpbmdVc2VyLmxlbmd0aCA+IDApIHtcclxuICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoNDAwKS5qc29uKHsgZXJyb3I6ICdFbWFpbCBpcyBhbHJlYWR5IGluIHVzZScgfSk7XHJcbiAgICB9XHJcbiAgICBjb25zdCBoYXNoZWRQYXNzd29yZCA9IGF3YWl0IGJjcnlwdC5oYXNoKHBhc3N3b3JkLCAxMCk7XHJcbiAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBxdWVyeShcclxuICAgICAgJ0lOU0VSVCBJTlRPIHJlZ2lzdGVyZWRfdXNlcnMgKGZpcnN0TmFtZSwgbGFzdE5hbWUsIGFkZHJlc3MsIGNvbnRhY3QsIGVtYWlsLCBwYXNzd29yZCkgVkFMVUVTICg/LCA/LCA/LCA/LCA/LCA/KScsXHJcbiAgICAgIFtmaXJzdG5hbWUsIGxhc3RuYW1lLCBhZGRyZXNzLCBtb2JpbGUsIGVtYWlsLCBoYXNoZWRQYXNzd29yZF1cclxuICAgICk7XHJcbiAgICBhd2FpdCBxdWVyeShcclxuICAgICAgJ0lOU0VSVCBJTlRPIHVzZXJfbG9naW4gKHVzZXJfZmlyc3RuYW1lLCB1c2VyX2xhc3RuYW1lLCBjb250YWN0LCBlbWFpbCkgVkFMVUVTICg/LCA/LCA/LCA/KScsXHJcbiAgICAgIFtmaXJzdG5hbWUsIGxhc3RuYW1lLCBtb2JpbGUsIGVtYWlsXVxyXG4gICAgKTtcclxuICAgIGNvbnN0IHRva2VuID0gc2lnbih7IHVzZXJJZDogcmVzdWx0Lmluc2VydElkIH0sIHByb2Nlc3MuZW52LkpXVF9TRUNSRVQsIHsgZXhwaXJlc0luOiAnNmgnIH0pO1xyXG4gICAgcmVzLnN0YXR1cygyMDApLmpzb24oeyBtZXNzYWdlOiAnU2lnbnVwIHN1Y2Nlc3NmdWwnLCB0b2tlbiB9KTtcclxuICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgY29uc29sZS5lcnJvcignU2lnbnVwIGVycm9yOicsIGVycm9yKTtcclxuICAgIHJlcy5zdGF0dXMoNTAwKS5qc29uKHsgZXJyb3I6ICdBbiBlcnJvciBvY2N1cnJlZCBkdXJpbmcgc2lnbnVwJyB9KTtcclxuICB9XHJcbn1cclxuXHJcbmFzeW5jIGZ1bmN0aW9uIGhhbmRsZVNpZ25pbihyZXEsIHJlcykge1xyXG4gIGNvbnN0IHsgZW1haWwsIHBhc3N3b3JkIH0gPSByZXEuYm9keTtcclxuXHJcbiAgdHJ5IHtcclxuICAgIGNvbnN0IHVzZXJzID0gYXdhaXQgcXVlcnkoJ1NFTEVDVCAqIEZST00gcmVnaXN0ZXJlZF91c2VycyBXSEVSRSBlbWFpbCA9ID8nLCBbZW1haWxdKTtcclxuICAgIGlmICh1c2Vycy5sZW5ndGggPT09IDApIHtcclxuICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoNDAxKS5qc29uKHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiAnSW52YWxpZCBlbWFpbCBvciBwYXNzd29yZCcgfSk7XHJcbiAgICB9XHJcbiAgICBjb25zdCB1c2VyID0gdXNlcnNbMF07XHJcbiAgICBjb25zdCBtYXRjaCA9IGF3YWl0IGJjcnlwdC5jb21wYXJlKHBhc3N3b3JkLCB1c2VyLnBhc3N3b3JkKTtcclxuXHJcbiAgICBpZiAoIW1hdGNoKSB7XHJcbiAgICAgIHJldHVybiByZXMuc3RhdHVzKDQwMSkuanNvbih7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogJ0ludmFsaWQgZW1haWwgb3IgcGFzc3dvcmQnIH0pO1xyXG4gICAgfVxyXG5cclxuICAgIGNvbnN0IHRva2VuID0gc2lnbih7IHVzZXJJZDogdXNlci5pZCB9LCBwcm9jZXNzLmVudi5KV1RfU0VDUkVULCB7IGV4cGlyZXNJbjogJzZoJyB9KTtcclxuXHJcbiAgICByZXEuc2Vzc2lvbi51c2VyID0ge1xyXG4gICAgICBpZDogdXNlci5pZCxcclxuICAgICAgZmlyc3ROYW1lOiB1c2VyLmZpcnN0TmFtZSxcclxuICAgICAgZW1haWw6IHVzZXIuZW1haWxcclxuICAgIH07XHJcbiAgICBhd2FpdCByZXEuc2Vzc2lvbi5zYXZlKCk7XHJcblxyXG4gICAgYXdhaXQgcXVlcnkoJ1VQREFURSB1c2VyX2xvZ2luIFNFVCBsb2dvdXRfdGltZSA9IE5VTEwgV0hFUkUgZW1haWwgPSA/JywgW2VtYWlsXSk7XHJcblxyXG4gICAgY29uc3QgbG9naW5UaW1lID0gbmV3IERhdGUoKTtcclxuICAgIGF3YWl0IHF1ZXJ5KCdVUERBVEUgdXNlcl9sb2dpbiBTRVQgbG9naW5fdGltZSA9ID8gV0hFUkUgZW1haWwgPSA/JywgW2xvZ2luVGltZSwgZW1haWxdKTtcclxuXHJcbiAgICByZXMuc2V0SGVhZGVyKCdTZXQtQ29va2llJywgYGF1dGhUb2tlbj0ke3Rva2VufTsgSHR0cE9ubHk7IFBhdGg9LzsgTWF4LUFnZT0zNjAwOyBTYW1lU2l0ZT1TdHJpY3Qke3Byb2Nlc3MuZW52Lk5PREVfRU5WID09PSAncHJvZHVjdGlvbicgPyAnOyBTZWN1cmUnIDogJyd9YCk7XHJcblxyXG4gICAgcmVzLnN0YXR1cygyMDApLmpzb24oeyBcclxuICAgICAgc3VjY2VzczogdHJ1ZSwgXHJcbiAgICAgIG1lc3NhZ2U6ICdTaWduaW4gc3VjY2Vzc2Z1bCcsIFxyXG4gICAgICB0b2tlbiwgXHJcbiAgICAgIGZpcnN0TmFtZTogdXNlci5maXJzdE5hbWUgXHJcbiAgICB9KTtcclxuICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgY29uc29sZS5lcnJvcignU2lnbmluIGVycm9yOicsIGVycm9yKTtcclxuICAgIHJlcy5zdGF0dXMoNTAwKS5qc29uKHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiAnQW4gZXJyb3Igb2NjdXJyZWQgZHVyaW5nIHNpZ25pbicgfSk7XHJcbiAgfVxyXG59XHJcbiAgXHJcbiAgZnVuY3Rpb24gaGFuZGxlQ2hlY2tBdXRoKHJlcSwgcmVzKSB7XHJcbiAgICBjb25zdCB0b2tlbiA9IHJlcS5oZWFkZXJzLmF1dGhvcml6YXRpb24/LnNwbGl0KCcgJylbMV07XHJcbiAgICBcclxuICAgIGlmICghdG9rZW4pIHtcclxuICAgICAgcmV0dXJuIHJlcy5qc29uKHsgaXNBdXRoZW50aWNhdGVkOiBmYWxzZSB9KTtcclxuICAgIH1cclxuICBcclxuICAgIHRyeSB7XHJcbiAgICAgIGNvbnN0IGRlY29kZWQgPSB2ZXJpZnkodG9rZW4sIHByb2Nlc3MuZW52LkpXVF9TRUNSRVQpO1xyXG4gICAgICBjb25zdCB1c2VySWQgPSBkZWNvZGVkLnVzZXJJZDtcclxuICBcclxuICAgICAgaWYgKHJlcS5zZXNzaW9uLnVzZXIgJiYgcmVxLnNlc3Npb24udXNlci5pZCA9PT0gdXNlcklkKSB7XHJcbiAgICAgICAgcmVzLmpzb24oeyBcclxuICAgICAgICAgIGlzQXV0aGVudGljYXRlZDogdHJ1ZSwgXHJcbiAgICAgICAgICB1c2VyOiB7IFxyXG4gICAgICAgICAgICBpZDogcmVxLnNlc3Npb24udXNlci5pZCxcclxuICAgICAgICAgICAgZmlyc3ROYW1lOiByZXEuc2Vzc2lvbi51c2VyLmZpcnN0TmFtZSxcclxuICAgICAgICAgICAgZW1haWw6IHJlcS5zZXNzaW9uLnVzZXIuZW1haWxcclxuICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICByZXEuc2Vzc2lvbi51c2VyID0geyBpZDogdXNlcklkIH07XHJcbiAgICAgICAgcmVzLmpzb24oeyBpc0F1dGhlbnRpY2F0ZWQ6IHRydWUsIHVzZXI6IHsgaWQ6IHVzZXJJZCB9IH0pO1xyXG4gICAgICB9XHJcbiAgICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgICBjb25zb2xlLmVycm9yKCdUb2tlbiB2ZXJpZmljYXRpb24gZXJyb3I6JywgZXJyb3IpO1xyXG4gICAgICByZXMuanNvbih7IGlzQXV0aGVudGljYXRlZDogZmFsc2UgfSk7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBmdW5jdGlvbiBoYW5kbGVHZXRVc2VyKHJlcSwgcmVzKSB7XHJcbiAgICBjb25zdCBhdXRoSGVhZGVyID0gcmVxLmhlYWRlcnMuYXV0aG9yaXphdGlvbjtcclxuICAgIGNvbnN0IHRva2VuID0gYXV0aEhlYWRlciAmJiBhdXRoSGVhZGVyLnNwbGl0KCcgJylbMV07XHJcbiAgXHJcbiAgICBpZiAoIXRva2VuKSB7XHJcbiAgICAgIGNvbnNvbGUubG9nKCdObyB0b2tlbiBwcm92aWRlZCBmb3IgL2FwaS91c2VyJyk7XHJcbiAgICAgIHJldHVybiByZXMuc3RhdHVzKDQwMSkuanNvbih7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogJ05vIHRva2VuIHByb3ZpZGVkJyB9KTtcclxuICAgIH1cclxuICBcclxuICAgIHRyeSB7XHJcbiAgICAgIGNvbnN0IGRlY29kZWQgPSB2ZXJpZnkodG9rZW4sIHByb2Nlc3MuZW52LkpXVF9TRUNSRVQpO1xyXG4gICAgICBxdWVyeSgnU0VMRUNUIGlkLCBmaXJzdE5hbWUsIGVtYWlsIEZST00gcmVnaXN0ZXJlZF91c2VycyBXSEVSRSBpZCA9ID8nLCBbZGVjb2RlZC51c2VySWRdKVxyXG4gICAgICAgIC50aGVuKHVzZXJzID0+IHtcclxuICAgICAgICAgIGlmICh1c2Vycy5sZW5ndGggPT09IDApIHtcclxuICAgICAgICAgICAgY29uc29sZS5sb2coYFVzZXIgbm90IGZvdW5kIGZvciBpZDogJHtkZWNvZGVkLnVzZXJJZH1gKTtcclxuICAgICAgICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoNDA0KS5qc29uKHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiAnVXNlciBub3QgZm91bmQnIH0pO1xyXG4gICAgICAgICAgfVxyXG4gIFxyXG4gICAgICAgICAgY29uc3QgdXNlciA9IHVzZXJzWzBdO1xyXG4gICAgICAgICAgcmVzLnN0YXR1cygyMDApLmpzb24oeyBzdWNjZXNzOiB0cnVlLCBmaXJzdE5hbWU6IHVzZXIuZmlyc3ROYW1lLCBlbWFpbDogdXNlci5lbWFpbCB9KTtcclxuICAgICAgICB9KVxyXG4gICAgICAgIC5jYXRjaChlcnJvciA9PiB7XHJcbiAgICAgICAgICBjb25zb2xlLmVycm9yKCdEYXRhYmFzZSBxdWVyeSBlcnJvcjonLCBlcnJvcik7XHJcbiAgICAgICAgICByZXMuc3RhdHVzKDUwMCkuanNvbih7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogJ0RhdGFiYXNlIGVycm9yJyB9KTtcclxuICAgICAgICB9KTtcclxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ0dldCB1c2VyIGVycm9yOicsIGVycm9yKTtcclxuICAgICAgaWYgKGVycm9yLm5hbWUgPT09ICdUb2tlbkV4cGlyZWRFcnJvcicpIHtcclxuICAgICAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDEpLmpzb24oeyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6ICdUb2tlbiBleHBpcmVkJywgY29kZTogJ1RPS0VOX0VYUElSRUQnIH0pO1xyXG4gICAgICB9XHJcbiAgICAgIHJlcy5zdGF0dXMoNDAxKS5qc29uKHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiAnSW52YWxpZCB0b2tlbicgfSk7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBhc3luYyBmdW5jdGlvbiBoYW5kbGVMb2dvdXQocmVxLCByZXMpIHtcclxuICAgIHRyeSB7XHJcbiAgICAgIGNvbnN0IHVzZXJFbWFpbCA9IHJlcS5oZWFkZXJzWyd1c2VyLWVtYWlsJ107XHJcbiAgICAgIGNvbnNvbGUubG9nKCdSZWNlaXZlZCBsb2dvdXQgcmVxdWVzdCBmb3IgdXNlcjonLCB1c2VyRW1haWwpO1xyXG4gIFxyXG4gICAgICBpZiAodXNlckVtYWlsKSB7XHJcbiAgICAgICAgY29uc3QgbG9nb3V0VGltZSA9IG5ldyBEYXRlKCk7XHJcbiAgICAgICAgY29uc29sZS5sb2coJ1VwZGF0aW5nIGxvZ291dCB0aW1lOicsIGxvZ291dFRpbWUpO1xyXG4gIFxyXG4gICAgICAgIHRyeSB7XHJcbiAgICAgICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBxdWVyeShcclxuICAgICAgICAgICAgJ1VQREFURSB1c2VyX2xvZ2luIFNFVCBsb2dvdXRfdGltZSA9ID8gV0hFUkUgZW1haWwgPSA/IEFORCBsb2dvdXRfdGltZSBJUyBOVUxMJyxcclxuICAgICAgICAgICAgW2xvZ291dFRpbWUsIHVzZXJFbWFpbF1cclxuICAgICAgICAgICk7XHJcbiAgICAgICAgICBjb25zb2xlLmxvZygnRGF0YWJhc2UgdXBkYXRlIHJlc3VsdDonLCByZXN1bHQpO1xyXG4gIFxyXG4gICAgICAgICAgaWYgKHJlc3VsdC5hZmZlY3RlZFJvd3MgPT09IDApIHtcclxuICAgICAgICAgICAgY29uc29sZS5sb2coJ05vIHJvd3MgdXBkYXRlZC4gVXNlciBtaWdodCBub3QgZXhpc3QgaW4gdXNlcl9sb2dpbiB0YWJsZSBvciBhbHJlYWR5IGxvZ2dlZCBvdXQuJyk7XHJcbiAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICBjb25zb2xlLmxvZygnTG9nb3V0IHRpbWUgdXBkYXRlZCBzdWNjZXNzZnVsbHkgZm9yIHVzZXI6JywgdXNlckVtYWlsKTtcclxuICAgICAgICAgIH1cclxuICAgICAgICB9IGNhdGNoIChkYkVycm9yKSB7XHJcbiAgICAgICAgICBjb25zb2xlLmVycm9yKCdEYXRhYmFzZSBlcnJvcjonLCBkYkVycm9yKTtcclxuICAgICAgICAgIHJldHVybiByZXMuc3RhdHVzKDUwMCkuanNvbih7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogJ0RhdGFiYXNlIGVycm9yIGR1cmluZyBsb2dvdXQnIH0pO1xyXG4gICAgICAgIH1cclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICBjb25zb2xlLmxvZygnTm8gdXNlciBlbWFpbCBwcm92aWRlZCBpbiByZXF1ZXN0IGhlYWRlcnMnKTtcclxuICAgICAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDApLmpzb24oeyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6ICdVc2VyIGVtYWlsIG5vdCBwcm92aWRlZCcgfSk7XHJcbiAgICAgIH1cclxuICBcclxuICAgICAgcmVzLnNldEhlYWRlcignU2V0LUNvb2tpZScsICdhdXRoVG9rZW49OyBIdHRwT25seTsgUGF0aD0vOyBNYXgtQWdlPTA7IFNhbWVTaXRlPVN0cmljdCcpO1xyXG4gICAgICByZXMuc3RhdHVzKDIwMCkuanNvbih7IHN1Y2Nlc3M6IHRydWUsIG1lc3NhZ2U6ICdMb2dvdXQgc3VjY2Vzc2Z1bCcgfSk7XHJcbiAgICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgICBjb25zb2xlLmVycm9yKCdMb2dvdXQgZXJyb3I6JywgZXJyb3IpO1xyXG4gICAgICByZXMuc3RhdHVzKDUwMCkuanNvbih7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogJ0FuIGVycm9yIG9jY3VycmVkIGR1cmluZyBsb2dvdXQnIH0pO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcblxyXG5cclxuLy9TaG93aW5nIHRoZSBQcm9kdWN0c1xyXG5hc3luYyBmdW5jdGlvbiBoYW5kbGVTZWFyY2gocmVxLCByZXMpIHtcclxuICBjb25zdCB7IHF1ZXJ5OiBzZWFyY2hRdWVyeSB9ID0gcGFyc2UocmVxLnVybCwgdHJ1ZSkucXVlcnk7XHJcbiAgXHJcbiAgaWYgKCFzZWFyY2hRdWVyeSkge1xyXG4gICAgcmV0dXJuIHJlcy5zdGF0dXMoNDAwKS5qc29uKHsgZXJyb3I6ICdTZWFyY2ggcXVlcnkgaXMgcmVxdWlyZWQnIH0pO1xyXG4gIH1cclxuXHJcbiAgdHJ5IHtcclxuICAgIGNvbnN0IHNlYXJjaFRlcm1zID0gc2VhcmNoUXVlcnkuc3BsaXQoL1xccysvKS5tYXAodGVybSA9PiBgJSR7dGVybX0lYCk7XHJcbiAgICBjb25zdCBwbGFjZWhvbGRlcnMgPSBzZWFyY2hUZXJtcy5tYXAoKCkgPT4gJyhwLm5hbWUgTElLRSA/IE9SIHAuY2F0ZWdvcnkgTElLRSA/KScpLmpvaW4oJyBBTkQgJyk7XHJcbiAgICBcclxuICAgIGNvbnN0IHNxbCA9IGBcclxuICAgICAgU0VMRUNUIHAuKiwgXHJcbiAgICAgICAgICAgICBDT0FMRVNDRShBVkcocHIucmF0aW5nKSwgNSkgYXMgYXZnX3JhdGluZyxcclxuICAgICAgICAgICAgIENPVU5UKHByLmlkKSBhcyByYXRpbmdfY291bnQsXHJcbiAgICAgICAgICAgICBDT0FMRVNDRShwcy5xdWFudGl0eSwgMCkgYXMgc3RvY2tfcXVhbnRpdHlcclxuICAgICAgRlJPTSBwcm9kdWN0cyBwXHJcbiAgICAgIExFRlQgSk9JTiBwcm9kdWN0X3JhdGluZ3MgcHIgT04gcC5pZCA9IHByLnByb2R1Y3RfaWRcclxuICAgICAgTEVGVCBKT0lOIHByb2R1Y3Rfc3RvY2tzIHBzIE9OIHAuaWQgPSBwcy5wcm9kdWN0X2lkXHJcbiAgICAgIFdIRVJFIHAuZGVsZXRlZCA9IDAgQU5EICgke3BsYWNlaG9sZGVyc30pXHJcbiAgICAgIEdST1VQIEJZIHAuaWRcclxuICAgIGA7XHJcblxyXG4gICAgY29uc3QgcGFyYW1zID0gc2VhcmNoVGVybXMuZmxhdE1hcCh0ZXJtID0+IFt0ZXJtLCB0ZXJtXSk7XHJcblxyXG4gICAgY29uc3QgcmVzdWx0cyA9IGF3YWl0IHF1ZXJ5KHNxbCwgcGFyYW1zKTtcclxuICAgIHJlcy5zdGF0dXMoMjAwKS5qc29uKHJlc3VsdHMpO1xyXG4gIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICBjb25zb2xlLmVycm9yKFwiRXJyb3Igc2VhcmNoaW5nIHByb2R1Y3RzOlwiLCBlcnJvcik7XHJcbiAgICByZXMuc3RhdHVzKDUwMCkuanNvbih7IGVycm9yOiAnQW4gZXJyb3Igb2NjdXJyZWQgd2hpbGUgc2VhcmNoaW5nIHByb2R1Y3RzJywgZGV0YWlsczogZXJyb3IubWVzc2FnZSB9KTtcclxuICB9XHJcbn1cclxuXHJcbmFzeW5jIGZ1bmN0aW9uIGhhbmRsZUdldFByb2R1Y3RzKHJlcSwgcmVzKSB7XHJcbiAgdHJ5IHtcclxuICAgIGNvbnN0IHByb2R1Y3RzUXVlcnkgPSBgXHJcbiAgICAgIFNFTEVDVCBwLiosIFxyXG4gICAgICAgICAgICAgQ09BTEVTQ0UoQVZHKHByLnJhdGluZyksIDUpIGFzIGF2Z19yYXRpbmcsXHJcbiAgICAgICAgICAgICBDT1VOVChwci5pZCkgYXMgcmF0aW5nX2NvdW50LFxyXG4gICAgICAgICAgICAgQ09BTEVTQ0UocHMucXVhbnRpdHksIDApIGFzIHN0b2NrX3F1YW50aXR5XHJcbiAgICAgIEZST00gcHJvZHVjdHMgcFxyXG4gICAgICBMRUZUIEpPSU4gcHJvZHVjdF9yYXRpbmdzIHByIE9OIHAuaWQgPSBwci5wcm9kdWN0X2lkXHJcbiAgICAgIExFRlQgSk9JTiBwcm9kdWN0X3N0b2NrcyBwcyBPTiBwLmlkID0gcHMucHJvZHVjdF9pZFxyXG4gICAgICBXSEVSRSBwLmRlbGV0ZWQgPSAwXHJcbiAgICAgIEdST1VQIEJZIHAuaWRcclxuICAgIGA7XHJcbiAgICBjb25zdCBwcm9kdWN0cyA9IGF3YWl0IHF1ZXJ5KHByb2R1Y3RzUXVlcnkpO1xyXG4gICAgcmVzLnN0YXR1cygyMDApLmpzb24ocHJvZHVjdHMpO1xyXG4gIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICBjb25zb2xlLmVycm9yKFwiRXJyb3IgZmV0Y2hpbmcgcHJvZHVjdHM6XCIsIGVycm9yKTtcclxuICAgIHJlcy5zdGF0dXMoNTAwKS5qc29uKHsgZXJyb3I6ICdBbiBlcnJvciBvY2N1cnJlZCB3aGlsZSBmZXRjaGluZyBwcm9kdWN0cycsIGRldGFpbHM6IGVycm9yLm1lc3NhZ2UgfSk7XHJcbiAgfVxyXG59XHJcblxyXG5hc3luYyBmdW5jdGlvbiBoYW5kbGVHZXRQcm9kdWN0c0J5Q2F0ZWdvcnkocmVxLCByZXMsIGNhdGVnb3J5KSB7XHJcbiAgdHJ5IHtcclxuICAgIGNvbnN0IGRlY29kZWRDYXRlZ29yeSA9IGRlY29kZVVSSUNvbXBvbmVudChjYXRlZ29yeSk7XHJcbiAgICBjb25zb2xlLmxvZyhgQXR0ZW1wdGluZyB0byBmZXRjaCBwcm9kdWN0cyBmb3IgY2F0ZWdvcnk6ICR7ZGVjb2RlZENhdGVnb3J5fWApO1xyXG4gICAgY29uc3QgcHJvZHVjdHNRdWVyeSA9IGBcclxuICAgICAgU0VMRUNUIHAuKiwgXHJcbiAgICAgICAgICAgICBDT0FMRVNDRShBVkcocHIucmF0aW5nKSwgNSkgYXMgYXZnX3JhdGluZyxcclxuICAgICAgICAgICAgIENPVU5UKHByLmlkKSBhcyByYXRpbmdfY291bnQsXHJcbiAgICAgICAgICAgICBDT0FMRVNDRShwcy5xdWFudGl0eSwgMCkgYXMgc3RvY2tfcXVhbnRpdHlcclxuICAgICAgRlJPTSBwcm9kdWN0cyBwXHJcbiAgICAgIExFRlQgSk9JTiBwcm9kdWN0X3JhdGluZ3MgcHIgT04gcC5pZCA9IHByLnByb2R1Y3RfaWRcclxuICAgICAgTEVGVCBKT0lOIHByb2R1Y3Rfc3RvY2tzIHBzIE9OIHAuaWQgPSBwcy5wcm9kdWN0X2lkXHJcbiAgICAgIFdIRVJFIHAuY2F0ZWdvcnkgPSA/IEFORCBwLmRlbGV0ZWQgPSAwXHJcbiAgICAgIEdST1VQIEJZIHAuaWRcclxuICAgIGA7XHJcbiAgICBjb25zdCBwcm9kdWN0cyA9IGF3YWl0IHF1ZXJ5KHByb2R1Y3RzUXVlcnksIFtkZWNvZGVkQ2F0ZWdvcnldKTtcclxuICAgIGNvbnNvbGUubG9nKGBGZXRjaGVkICR7cHJvZHVjdHMubGVuZ3RofSBwcm9kdWN0cyBmb3IgY2F0ZWdvcnk6ICR7ZGVjb2RlZENhdGVnb3J5fWApO1xyXG4gICAgcmVzLnN0YXR1cygyMDApLmpzb24ocHJvZHVjdHMpO1xyXG4gIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICBjb25zb2xlLmVycm9yKFwiRXJyb3IgZmV0Y2hpbmcgcHJvZHVjdHMgYnkgY2F0ZWdvcnk6XCIsIGVycm9yKTtcclxuICAgIHJlcy5zdGF0dXMoNTAwKS5qc29uKHsgZXJyb3I6ICdBbiBlcnJvciBvY2N1cnJlZCB3aGlsZSBmZXRjaGluZyBwcm9kdWN0cyBieSBjYXRlZ29yeScsIGRldGFpbHM6IGVycm9yLm1lc3NhZ2UsIHN0YWNrOiBlcnJvci5zdGFjayB9KTtcclxuICB9XHJcbn1cclxuXHJcbmFzeW5jIGZ1bmN0aW9uIGhhbmRsZUdldExpbWl0ZWRJdGVtcyhyZXEsIHJlcykge1xyXG4gIHRyeSB7XHJcbiAgICBjb25zb2xlLmxvZyhcIkF0dGVtcHRpbmcgdG8gZmV0Y2ggbGltaXRlZCBpdGVtc1wiKTtcclxuICAgIGNvbnN0IGxpbWl0ZWRJdGVtc1F1ZXJ5ID0gYFxyXG4gICAgICBTRUxFQ1QgcC4qLCBcclxuICAgICAgICAgICAgIENPQUxFU0NFKEFWRyhwci5yYXRpbmcpLCA1KSBhcyBhdmdfcmF0aW5nLFxyXG4gICAgICAgICAgICAgQ09VTlQocHIuaWQpIGFzIHJhdGluZ19jb3VudCxcclxuICAgICAgICAgICAgIENPQUxFU0NFKHBzLnF1YW50aXR5LCAwKSBhcyBzdG9ja19xdWFudGl0eVxyXG4gICAgICBGUk9NIHByb2R1Y3RzIHBcclxuICAgICAgTEVGVCBKT0lOIHByb2R1Y3RfcmF0aW5ncyBwciBPTiBwLmlkID0gcHIucHJvZHVjdF9pZFxyXG4gICAgICBMRUZUIEpPSU4gcHJvZHVjdF9zdG9ja3MgcHMgT04gcC5pZCA9IHBzLnByb2R1Y3RfaWRcclxuICAgICAgV0hFUkUgcC5jYXRlZ29yeSA9ICdMaW1pdGVkIEl0ZW1zJyBBTkQgcC5kZWxldGVkID0gMFxyXG4gICAgICBHUk9VUCBCWSBwLmlkXHJcbiAgICBgO1xyXG4gICAgY29uc3QgbGltaXRlZEl0ZW1zID0gYXdhaXQgcXVlcnkobGltaXRlZEl0ZW1zUXVlcnkpO1xyXG4gICAgY29uc29sZS5sb2coXCJRdWVyeSByZXN1bHQ6XCIsIGxpbWl0ZWRJdGVtcyk7XHJcbiAgICByZXMuc3RhdHVzKDIwMCkuanNvbihsaW1pdGVkSXRlbXMpO1xyXG4gIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICBjb25zb2xlLmVycm9yKFwiRXJyb3IgZmV0Y2hpbmcgbGltaXRlZCBpdGVtczpcIiwgZXJyb3IpO1xyXG4gICAgcmVzLnN0YXR1cyg1MDApLmpzb24oeyBlcnJvcjogJ0FuIGVycm9yIG9jY3VycmVkIHdoaWxlIGZldGNoaW5nIGxpbWl0ZWQgaXRlbXMnLCBkZXRhaWxzOiBlcnJvci5tZXNzYWdlLCBzdGFjazogZXJyb3Iuc3RhY2sgfSk7XHJcbiAgfVxyXG59XHJcbiAgXHJcbiAgYXN5bmMgZnVuY3Rpb24gaGFuZGxlR2V0Q2F0ZWdvcmllcyhyZXEsIHJlcykge1xyXG4gICAgdHJ5IHtcclxuICAgICAgY29uc3QgY2F0ZWdvcmllcyA9IGF3YWl0IHF1ZXJ5KGBcclxuICAgICAgICBTRUxFQ1QgRElTVElOQ1QgY2F0ZWdvcnkgXHJcbiAgICAgICAgRlJPTSBwcm9kdWN0cyBcclxuICAgICAgICBXSEVSRSBkZWxldGVkID0gMCBBTkQgY2F0ZWdvcnkgIT0gJ0xpbWl0ZWQnXHJcbiAgICAgIGApO1xyXG4gICAgICBjb25zdCBmb3JtYXR0ZWRDYXRlZ29yaWVzID0gY2F0ZWdvcmllcy5tYXAoaXRlbSA9PiAoeyBpZDogaXRlbS5jYXRlZ29yeSwgbmFtZTogaXRlbS5jYXRlZ29yeSB9KSk7XHJcbiAgICAgIHJlcy5zdGF0dXMoMjAwKS5qc29uKGZvcm1hdHRlZENhdGVnb3JpZXMpO1xyXG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgICAgY29uc29sZS5lcnJvcihcIkVycm9yIGZldGNoaW5nIGNhdGVnb3JpZXM6XCIsIGVycm9yKTtcclxuICAgICAgcmVzLnN0YXR1cyg1MDApLmpzb24oeyBlcnJvcjogJ0FuIGVycm9yIG9jY3VycmVkIHdoaWxlIGZldGNoaW5nIGNhdGVnb3JpZXMnLCBkZXRhaWxzOiBlcnJvci5tZXNzYWdlIH0pO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcblxyXG5cclxuXHJcbi8vUGxhY2luZyBvciBDaGVja291dCBhbiBPcmRlclxyXG5hc3luYyBmdW5jdGlvbiBoYW5kbGVQbGFjZU9yZGVyKHJlcSwgcmVzKSB7XHJcbiAgY29uc3QgYXV0aEhlYWRlciA9IHJlcS5oZWFkZXJzLmF1dGhvcml6YXRpb247XHJcbiAgaWYgKCFhdXRoSGVhZGVyKSB7XHJcbiAgICBjb25zb2xlLmxvZygnTm8gQXV0aG9yaXphdGlvbiBoZWFkZXIgZm91bmQnKTtcclxuICAgIHJldHVybiByZXMuc3RhdHVzKDQwMSkuanNvbih7IGVycm9yOiAnTm8gdG9rZW4gcHJvdmlkZWQnIH0pO1xyXG4gIH1cclxuXHJcbiAgY29uc3QgdG9rZW4gPSBhdXRoSGVhZGVyLnNwbGl0KCcgJylbMV07XHJcbiAgaWYgKCF0b2tlbikge1xyXG4gICAgY29uc29sZS5sb2coJ1Rva2VuIG5vdCBmb3VuZCBpbiBBdXRob3JpemF0aW9uIGhlYWRlcicpO1xyXG4gICAgcmV0dXJuIHJlcy5zdGF0dXMoNDAxKS5qc29uKHsgZXJyb3I6ICdObyB0b2tlbiBwcm92aWRlZCcgfSk7XHJcbiAgfVxyXG5cclxuICB0cnkge1xyXG4gICAgY29uc3QgZGVjb2RlZCA9IHZlcmlmeSh0b2tlbiwgcHJvY2Vzcy5lbnYuSldUX1NFQ1JFVCk7XHJcbiAgICBjb25zdCB1c2VySWQgPSBkZWNvZGVkLnVzZXJJZDtcclxuXHJcbiAgICBjb25zdCB7IGJpbGxpbmdJbmZvLCBwYXltZW50TWV0aG9kLCBjYXJ0SXRlbXMsIHN1YnRvdGFsLCBkZWxpdmVyeSwgdG90YWwgfSA9IHJlcS5ib2R5O1xyXG4gICAgY29uc3QgdHJhY2tpbmdOdW1iZXIgPSBjcnlwdG8ucmFuZG9tQnl0ZXMoOCkudG9TdHJpbmcoJ2hleCcpLnRvVXBwZXJDYXNlKCk7XHJcblxyXG4gICAgYXdhaXQgcXVlcnkoJ1NUQVJUIFRSQU5TQUNUSU9OJyk7XHJcblxyXG4gICAgLy8gSW5zZXJ0IHRoZSBvcmRlclxyXG4gICAgY29uc3Qgb3JkZXJSZXN1bHQgPSBhd2FpdCBxdWVyeShcclxuICAgICAgJ0lOU0VSVCBJTlRPIG9yZGVycyAodXNlcl9pZCwgZnVsbF9uYW1lLCBwaG9uZV9udW1iZXIsIGFkZHJlc3MsIGNpdHksIHN0YXRlX3Byb3ZpbmNlLCBwb3N0YWxfY29kZSwgZGVsaXZlcnlfYWRkcmVzcywgcGF5bWVudF9tZXRob2QsIHN1YnRvdGFsLCBkZWxpdmVyeV9mZWUsIHRvdGFsLCB0cmFja2luZ19udW1iZXIsIHN0YXR1cykgVkFMVUVTICg/LCA/LCA/LCA/LCA/LCA/LCA/LCA/LCA/LCA/LCA/LCA/LCA/LCA/KScsXHJcbiAgICAgIFt1c2VySWQsIGJpbGxpbmdJbmZvLmZ1bGxOYW1lLCBiaWxsaW5nSW5mby5waG9uZU51bWJlciwgYmlsbGluZ0luZm8uYWRkcmVzcywgYmlsbGluZ0luZm8uY2l0eSwgYmlsbGluZ0luZm8uc3RhdGVQcm92aW5jZSwgYmlsbGluZ0luZm8ucG9zdGFsQ29kZSwgYmlsbGluZ0luZm8uZGVsaXZlcnlBZGRyZXNzLCBwYXltZW50TWV0aG9kLCBzdWJ0b3RhbCwgZGVsaXZlcnksIHRvdGFsLCB0cmFja2luZ051bWJlciwgJ09yZGVyIFBsYWNlZCddXHJcbiAgICApO1xyXG5cclxuICAgIGNvbnN0IG9yZGVySWQgPSBvcmRlclJlc3VsdC5pbnNlcnRJZDtcclxuXHJcbiAgICAvLyBJbnNlcnQgb3JkZXJlZCBwcm9kdWN0cyBhbmQgdXBkYXRlIHN0b2NrIHF1YW50aXR5XHJcbiAgICBmb3IgKGNvbnN0IGl0ZW0gb2YgY2FydEl0ZW1zKSB7XHJcbiAgICAgIC8vIENoZWNrIGlmIHRoZXJlJ3MgZW5vdWdoIHN0b2NrIGJlZm9yZSBwbGFjaW5nIHRoZSBvcmRlclxyXG4gICAgICBjb25zdCBbc3RvY2tSZWNvcmRdID0gYXdhaXQgcXVlcnkoXHJcbiAgICAgICAgJ1NFTEVDVCBxdWFudGl0eSBGUk9NIHByb2R1Y3Rfc3RvY2tzIFdIRVJFIHByb2R1Y3RfaWQgPSA/JyxcclxuICAgICAgICBbaXRlbS5pZF1cclxuICAgICAgKTtcclxuXHJcbiAgICAgIGlmICghc3RvY2tSZWNvcmQgfHwgc3RvY2tSZWNvcmQucXVhbnRpdHkgPCBpdGVtLnF1YW50aXR5KSB7XHJcbiAgICAgICAgYXdhaXQgcXVlcnkoJ1JPTExCQUNLJyk7XHJcbiAgICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoNDAwKS5qc29uKHsgZXJyb3I6IGBOb3QgZW5vdWdoIHN0b2NrIGZvciBwcm9kdWN0OiAke2l0ZW0ubmFtZX1gIH0pO1xyXG4gICAgICB9XHJcblxyXG4gICAgICBhd2FpdCBxdWVyeShcclxuICAgICAgICAnSU5TRVJUIElOVE8gb3JkZXJlZF9wcm9kdWN0cyAobmFtZSwgcHJvZHVjdF9pZCwgb3JkZXJfaWQsIHF1YW50aXR5LCBwcmljZSkgVkFMVUVTICg/LCA/LCA/LCA/LCA/KScsXHJcbiAgICAgICAgW2l0ZW0ubmFtZSwgaXRlbS5pZCwgb3JkZXJJZCwgaXRlbS5xdWFudGl0eSwgaXRlbS5wcmljZV1cclxuICAgICAgKTtcclxuXHJcbiAgICAgIC8vIFVwZGF0ZSBzdG9jayBxdWFudGl0eSBpbiBwcm9kdWN0X3N0b2NrcyB0YWJsZVxyXG4gICAgICBjb25zdCB1cGRhdGVSZXN1bHQgPSBhd2FpdCBxdWVyeShcclxuICAgICAgICAnVVBEQVRFIHByb2R1Y3Rfc3RvY2tzIFNFVCBxdWFudGl0eSA9IHF1YW50aXR5IC0gPyBXSEVSRSBwcm9kdWN0X2lkID0gPycsXHJcbiAgICAgICAgW2l0ZW0ucXVhbnRpdHksIGl0ZW0uaWRdXHJcbiAgICAgICk7XHJcblxyXG4gICAgICBpZiAodXBkYXRlUmVzdWx0LmFmZmVjdGVkUm93cyA9PT0gMCkge1xyXG4gICAgICAgIGF3YWl0IHF1ZXJ5KCdST0xMQkFDSycpO1xyXG4gICAgICAgIHJldHVybiByZXMuc3RhdHVzKDQwMCkuanNvbih7IGVycm9yOiBgTm90IGVub3VnaCBzdG9jayBmb3IgcHJvZHVjdDogJHtpdGVtLm5hbWV9YCB9KTtcclxuICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIGF3YWl0IHF1ZXJ5KCdDT01NSVQnKTtcclxuICAgIHJlcy5qc29uKHsgc3VjY2VzczogdHJ1ZSwgb3JkZXJJZCwgdHJhY2tpbmdOdW1iZXIgfSk7XHJcbiAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgIGF3YWl0IHF1ZXJ5KCdST0xMQkFDSycpO1xyXG4gICAgY29uc29sZS5lcnJvcignRXJyb3IgcGxhY2luZyBvcmRlcjonLCBlcnJvcik7XHJcbiAgICBpZiAoZXJyb3IubmFtZSA9PT0gJ0pzb25XZWJUb2tlbkVycm9yJykge1xyXG4gICAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDEpLmpzb24oeyBlcnJvcjogJ0ludmFsaWQgdG9rZW4nIH0pO1xyXG4gICAgfVxyXG4gICAgcmVzLnN0YXR1cyg1MDApLmpzb24oeyBlcnJvcjogJ0FuIGVycm9yIG9jY3VycmVkIHdoaWxlIHBsYWNpbmcgdGhlIG9yZGVyJyB9KTtcclxuICB9XHJcbn1cclxuXHJcbi8vT3JkZXIgVHJhY2tpbmcgYWZ0ZXIgQ2hlY2tvdXQgb3IgUGxhY2luZyBhbiBPcmRlclxyXG5hc3luYyBmdW5jdGlvbiBoYW5kbGVHZXRPcmRlcihyZXEsIHJlcykge1xyXG4gIGNvbnN0IGF1dGhIZWFkZXIgPSByZXEuaGVhZGVycy5hdXRob3JpemF0aW9uO1xyXG4gIGlmICghYXV0aEhlYWRlcikge1xyXG4gICAgcmV0dXJuIHJlcy5zdGF0dXMoNDAxKS5qc29uKHsgZXJyb3I6ICdObyB0b2tlbiBwcm92aWRlZCcgfSk7XHJcbiAgfVxyXG5cclxuICBjb25zdCB0b2tlbiA9IGF1dGhIZWFkZXIuc3BsaXQoJyAnKVsxXTtcclxuICBpZiAoIXRva2VuKSB7XHJcbiAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDEpLmpzb24oeyBlcnJvcjogJ05vIHRva2VuIHByb3ZpZGVkJyB9KTtcclxuICB9XHJcblxyXG4gIHRyeSB7XHJcbiAgICBjb25zdCBkZWNvZGVkID0gdmVyaWZ5KHRva2VuLCBwcm9jZXNzLmVudi5KV1RfU0VDUkVUKTtcclxuICAgIGNvbnN0IHVzZXJJZCA9IGRlY29kZWQudXNlcklkO1xyXG5cclxuICAgIGNvbnN0IG9yZGVySWQgPSByZXEucXVlcnkub3JkZXJJZCB8fCByZXEudXJsLnNwbGl0KCcvJykucG9wKCk7XHJcblxyXG4gICAgY29uc3QgcmVzdWx0cyA9IGF3YWl0IHF1ZXJ5KGBcclxuICAgICAgU0VMRUNUIG8uKiwgb3AubmFtZSwgb3AucHJvZHVjdF9pZCwgb3AucXVhbnRpdHksIG9wLnByaWNlLCBwLmltYWdlX3VybFxyXG4gICAgICBGUk9NIG9yZGVycyBvXHJcbiAgICAgIEpPSU4gb3JkZXJlZF9wcm9kdWN0cyBvcCBPTiBvLmlkID0gb3Aub3JkZXJfaWRcclxuICAgICAgSk9JTiBwcm9kdWN0cyBwIE9OIG9wLnByb2R1Y3RfaWQgPSBwLmlkXHJcbiAgICAgIFdIRVJFIG8uaWQgPSA/IEFORCBvLnVzZXJfaWQgPSA/XHJcbiAgICBgLCBbb3JkZXJJZCwgdXNlcklkXSk7XHJcblxyXG4gICAgaWYgKHJlc3VsdHMubGVuZ3RoID09PSAwKSB7XHJcbiAgICAgIHJldHVybiByZXMuc3RhdHVzKDQwNCkuanNvbih7IGVycm9yOiAnT3JkZXIgbm90IGZvdW5kJyB9KTtcclxuICAgIH1cclxuXHJcbiAgICBjb25zdCBvcmRlckRldGFpbHMgPSB7XHJcbiAgICAgIG9yZGVySWQ6IHJlc3VsdHNbMF0uaWQsXHJcbiAgICAgIHRyYWNraW5nTnVtYmVyOiByZXN1bHRzWzBdLnRyYWNraW5nX251bWJlcixcclxuICAgICAgc3RhdHVzOiByZXN1bHRzWzBdLnN0YXR1cyxcclxuICAgICAgYmlsbGluZ0luZm86IHtcclxuICAgICAgICBmdWxsTmFtZTogcmVzdWx0c1swXS5mdWxsX25hbWUsXHJcbiAgICAgICAgcGhvbmVOdW1iZXI6IHJlc3VsdHNbMF0ucGhvbmVfbnVtYmVyLFxyXG4gICAgICAgIGFkZHJlc3M6IHJlc3VsdHNbMF0uYWRkcmVzcyxcclxuICAgICAgICBjaXR5OiByZXN1bHRzWzBdLmNpdHksXHJcbiAgICAgICAgc3RhdGVQcm92aW5jZTogcmVzdWx0c1swXS5zdGF0ZV9wcm92aW5jZSxcclxuICAgICAgICBwb3N0YWxDb2RlOiByZXN1bHRzWzBdLnBvc3RhbF9jb2RlLFxyXG4gICAgICAgIGRlbGl2ZXJ5QWRkcmVzczogcmVzdWx0c1swXS5kZWxpdmVyeV9hZGRyZXNzLFxyXG4gICAgICB9LFxyXG4gICAgICBwYXltZW50TWV0aG9kOiByZXN1bHRzWzBdLnBheW1lbnRfbWV0aG9kLFxyXG4gICAgICBpdGVtczogcmVzdWx0cy5tYXAoaXRlbSA9PiAoe1xyXG4gICAgICAgIGlkOiBpdGVtLnByb2R1Y3RfaWQsXHJcbiAgICAgICAgbmFtZTogaXRlbS5uYW1lLFxyXG4gICAgICAgIHF1YW50aXR5OiBpdGVtLnF1YW50aXR5LFxyXG4gICAgICAgIHByaWNlOiBpdGVtLnByaWNlLFxyXG4gICAgICAgIGltYWdlVXJsOiBpdGVtLmltYWdlX3VybCxcclxuICAgICAgfSkpLFxyXG4gICAgICBzdWJ0b3RhbDogcmVzdWx0c1swXS5zdWJ0b3RhbCxcclxuICAgICAgZGVsaXZlcnk6IHJlc3VsdHNbMF0uZGVsaXZlcnlfZmVlLFxyXG4gICAgICB0b3RhbDogcmVzdWx0c1swXS50b3RhbCxcclxuICAgIH07XHJcblxyXG4gICAgcmVzLmpzb24ob3JkZXJEZXRhaWxzKTtcclxuICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgY29uc29sZS5lcnJvcignRXJyb3IgZmV0Y2hpbmcgb3JkZXIgZGV0YWlsczonLCBlcnJvcik7XHJcbiAgICBpZiAoZXJyb3IubmFtZSA9PT0gJ0pzb25XZWJUb2tlbkVycm9yJykge1xyXG4gICAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDEpLmpzb24oeyBlcnJvcjogJ0ludmFsaWQgdG9rZW4nIH0pO1xyXG4gICAgfVxyXG4gICAgcmVzLnN0YXR1cyg1MDApLmpzb24oeyBlcnJvcjogJ0FuIGVycm9yIG9jY3VycmVkIHdoaWxlIGZldGNoaW5nIG9yZGVyIGRldGFpbHMnIH0pO1xyXG4gIH1cclxufVxyXG5cclxuLy9PcmRlciBIaXN0b3J5XHJcbmFzeW5jIGZ1bmN0aW9uIGhhbmRsZUFsbE9yZGVycyhyZXEsIHJlcykge1xyXG4gIGNvbnN0IGF1dGhIZWFkZXIgPSByZXEuaGVhZGVycy5hdXRob3JpemF0aW9uO1xyXG4gIGlmICghYXV0aEhlYWRlcikge1xyXG4gICAgcmV0dXJuIHJlcy5zdGF0dXMoNDAxKS5qc29uKHsgZXJyb3I6ICdObyB0b2tlbiBwcm92aWRlZCcgfSk7XHJcbiAgfVxyXG5cclxuICBjb25zdCB0b2tlbiA9IGF1dGhIZWFkZXIuc3BsaXQoJyAnKVsxXTtcclxuICBpZiAoIXRva2VuKSB7XHJcbiAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDEpLmpzb24oeyBlcnJvcjogJ05vIHRva2VuIHByb3ZpZGVkJyB9KTtcclxuICB9XHJcblxyXG4gIHRyeSB7XHJcbiAgICBjb25zdCBkZWNvZGVkID0gdmVyaWZ5KHRva2VuLCBwcm9jZXNzLmVudi5KV1RfU0VDUkVUKTtcclxuICAgIGNvbnN0IHVzZXJJZCA9IGRlY29kZWQudXNlcklkO1xyXG5cclxuICAgIGNvbnN0IG9yZGVycyA9IGF3YWl0IHF1ZXJ5KGBcclxuICAgICAgU0VMRUNUIGlkLCB0cmFja2luZ19udW1iZXIsIHN0YXR1cywgb3JkZXJfZGF0ZSwgdG90YWxcclxuICAgICAgRlJPTSBvcmRlcnNcclxuICAgICAgV0hFUkUgdXNlcl9pZCA9ID9cclxuICAgICAgT1JERVIgQlkgb3JkZXJfZGF0ZSBERVNDXHJcbiAgICBgLCBbdXNlcklkXSk7XHJcblxyXG4gICAgcmVzLnN0YXR1cygyMDApLmpzb24ob3JkZXJzKTtcclxuICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgaWYgKGVycm9yLm5hbWUgPT09ICdKc29uV2ViVG9rZW5FcnJvcicpIHtcclxuICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoNDAxKS5qc29uKHsgZXJyb3I6ICdJbnZhbGlkIHRva2VuJyB9KTtcclxuICAgIH1cclxuICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGZldGNoaW5nIGFsbCBvcmRlcnM6JywgZXJyb3IpO1xyXG4gICAgcmVzLnN0YXR1cyg1MDApLmpzb24oeyBlcnJvcjogJ0FuIGVycm9yIG9jY3VycmVkIHdoaWxlIGZldGNoaW5nIG9yZGVycycsIGRldGFpbHM6IGVycm9yLm1lc3NhZ2UgfSk7XHJcbiAgfVxyXG59XHJcblxyXG5hc3luYyBmdW5jdGlvbiBoYW5kbGVDYW5jZWxPcmRlcihyZXEsIHJlcykge1xyXG4gIGNvbnN0IGF1dGhIZWFkZXIgPSByZXEuaGVhZGVycy5hdXRob3JpemF0aW9uO1xyXG4gIGlmICghYXV0aEhlYWRlcikge1xyXG4gICAgcmV0dXJuIHJlcy5zdGF0dXMoNDAxKS5qc29uKHsgZXJyb3I6ICdObyB0b2tlbiBwcm92aWRlZCcgfSk7XHJcbiAgfVxyXG5cclxuICBjb25zdCB0b2tlbiA9IGF1dGhIZWFkZXIuc3BsaXQoJyAnKVsxXTtcclxuICBpZiAoIXRva2VuKSB7XHJcbiAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDEpLmpzb24oeyBlcnJvcjogJ05vIHRva2VuIHByb3ZpZGVkJyB9KTtcclxuICB9XHJcblxyXG4gIHRyeSB7XHJcbiAgICBjb25zdCBkZWNvZGVkID0gdmVyaWZ5KHRva2VuLCBwcm9jZXNzLmVudi5KV1RfU0VDUkVUKTtcclxuICAgIGNvbnN0IHVzZXJJZCA9IGRlY29kZWQudXNlcklkO1xyXG5cclxuICAgIGNvbnN0IG9yZGVySWQgPSByZXEudXJsLnNwbGl0KCcvJykucG9wKCk7XHJcblxyXG4gICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgcXVlcnkoYFxyXG4gICAgICBVUERBVEUgb3JkZXJzXHJcbiAgICAgIFNFVCBzdGF0dXMgPSAnQ2FuY2VsbGVkJ1xyXG4gICAgICBXSEVSRSBpZCA9ID8gQU5EIHVzZXJfaWQgPSA/IEFORCBzdGF0dXMgPSAnT3JkZXIgUGxhY2VkJ1xyXG4gICAgYCwgW29yZGVySWQsIHVzZXJJZF0pO1xyXG5cclxuICAgIGlmIChyZXN1bHQuYWZmZWN0ZWRSb3dzID09PSAwKSB7XHJcbiAgICAgIHJldHVybiByZXMuc3RhdHVzKDQwMCkuanNvbih7IGVycm9yOiAnT3JkZXIgbm90IGZvdW5kIG9yIGNhbm5vdCBiZSBjYW5jZWxsZWQnIH0pO1xyXG4gICAgfVxyXG5cclxuICAgIHJlcy5qc29uKHsgc3VjY2VzczogdHJ1ZSwgbWVzc2FnZTogJ09yZGVyIGNhbmNlbGxlZCBzdWNjZXNzZnVsbHknIH0pO1xyXG4gIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICBpZiAoZXJyb3IubmFtZSA9PT0gJ0pzb25XZWJUb2tlbkVycm9yJykge1xyXG4gICAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDEpLmpzb24oeyBlcnJvcjogJ0ludmFsaWQgdG9rZW4nIH0pO1xyXG4gICAgfVxyXG4gICAgY29uc29sZS5lcnJvcignRXJyb3IgY2FuY2VsbGluZyBvcmRlcjonLCBlcnJvcik7XHJcbiAgICByZXMuc3RhdHVzKDUwMCkuanNvbih7IGVycm9yOiAnQW4gZXJyb3Igb2NjdXJyZWQgd2hpbGUgY2FuY2VsbGluZyB0aGUgb3JkZXInIH0pO1xyXG4gIH1cclxufVxyXG5cclxuYXN5bmMgZnVuY3Rpb24gaGFuZGxlT3JkZXJIaXN0b3J5KHJlcSwgcmVzKSB7XHJcbiAgY29uc3QgYXV0aEhlYWRlciA9IHJlcS5oZWFkZXJzLmF1dGhvcml6YXRpb247XHJcbiAgaWYgKCFhdXRoSGVhZGVyKSB7XHJcbiAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDEpLmpzb24oeyBlcnJvcjogJ05vIHRva2VuIHByb3ZpZGVkJyB9KTtcclxuICB9XHJcblxyXG4gIGNvbnN0IHRva2VuID0gYXV0aEhlYWRlci5zcGxpdCgnICcpWzFdO1xyXG4gIGlmICghdG9rZW4pIHtcclxuICAgIHJldHVybiByZXMuc3RhdHVzKDQwMSkuanNvbih7IGVycm9yOiAnTm8gdG9rZW4gcHJvdmlkZWQnIH0pO1xyXG4gIH1cclxuXHJcbiAgdHJ5IHtcclxuICAgIGNvbnN0IGRlY29kZWQgPSB2ZXJpZnkodG9rZW4sIHByb2Nlc3MuZW52LkpXVF9TRUNSRVQpO1xyXG4gICAgY29uc3QgdXNlcklkID0gZGVjb2RlZC51c2VySWQ7XHJcblxyXG4gICAgY29uc3Qgb3JkZXJzID0gYXdhaXQgcXVlcnkoYFxyXG4gICAgICBTRUxFQ1Qgby5pZCwgby50cmFja2luZ19udW1iZXIsIG8uc3RhdHVzLCBvLm9yZGVyX2RhdGUsIG8udG90YWwsIG8uaXNfcmF0ZWQsXHJcbiAgICAgICAgICAgICBHUk9VUF9DT05DQVQob3AubmFtZSBTRVBBUkFUT1IgJywgJykgQVMgcHJvZHVjdHNcclxuICAgICAgRlJPTSBvcmRlcnMgb1xyXG4gICAgICBKT0lOIG9yZGVyZWRfcHJvZHVjdHMgb3AgT04gby5pZCA9IG9wLm9yZGVyX2lkXHJcbiAgICAgIFdIRVJFIG8udXNlcl9pZCA9ID9cclxuICAgICAgR1JPVVAgQlkgby5pZFxyXG4gICAgICBPUkRFUiBCWSBvLm9yZGVyX2RhdGUgREVTQ1xyXG4gICAgYCwgW3VzZXJJZF0pO1xyXG5cclxuICAgIHJlcy5zdGF0dXMoMjAwKS5qc29uKG9yZGVycyk7XHJcbiAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgIGlmIChlcnJvci5uYW1lID09PSAnSnNvbldlYlRva2VuRXJyb3InKSB7XHJcbiAgICAgIHJldHVybiByZXMuc3RhdHVzKDQwMSkuanNvbih7IGVycm9yOiAnSW52YWxpZCB0b2tlbicgfSk7XHJcbiAgICB9XHJcbiAgICBjb25zb2xlLmVycm9yKCdFcnJvciBmZXRjaGluZyBvcmRlciBoaXN0b3J5OicsIGVycm9yKTtcclxuICAgIHJlcy5zdGF0dXMoNTAwKS5qc29uKHsgZXJyb3I6ICdBbiBlcnJvciBvY2N1cnJlZCB3aGlsZSBmZXRjaGluZyBvcmRlciBoaXN0b3J5JywgZGV0YWlsczogZXJyb3IubWVzc2FnZSB9KTtcclxuICB9XHJcbn1cclxuXHJcbmFzeW5jIGZ1bmN0aW9uIGhhbmRsZVN1Ym1pdFJhdGluZ3MocmVxLCByZXMpIHtcclxuICBjb25zdCBhdXRoSGVhZGVyID0gcmVxLmhlYWRlcnMuYXV0aG9yaXphdGlvbjtcclxuICBpZiAoIWF1dGhIZWFkZXIpIHtcclxuICAgIHJldHVybiByZXMuc3RhdHVzKDQwMSkuanNvbih7IGVycm9yOiAnTm8gdG9rZW4gcHJvdmlkZWQnIH0pO1xyXG4gIH1cclxuXHJcbiAgY29uc3QgdG9rZW4gPSBhdXRoSGVhZGVyLnNwbGl0KCcgJylbMV07XHJcbiAgaWYgKCF0b2tlbikge1xyXG4gICAgcmV0dXJuIHJlcy5zdGF0dXMoNDAxKS5qc29uKHsgZXJyb3I6ICdObyB0b2tlbiBwcm92aWRlZCcgfSk7XHJcbiAgfVxyXG5cclxuICB0cnkge1xyXG4gICAgY29uc3QgZGVjb2RlZCA9IHZlcmlmeSh0b2tlbiwgcHJvY2Vzcy5lbnYuSldUX1NFQ1JFVCk7XHJcbiAgICBjb25zdCB1c2VySWQgPSBkZWNvZGVkLnVzZXJJZDtcclxuXHJcbiAgICBjb25zdCBvcmRlcklkID0gcmVxLnVybC5zcGxpdCgnLycpLnBvcCgpO1xyXG4gICAgY29uc3QgeyByYXRpbmdzLCBmZWVkYmFjayB9ID0gcmVxLmJvZHk7XHJcblxyXG4gICAgLy8gVmVyaWZ5IHRoYXQgdGhlIG9yZGVyIGJlbG9uZ3MgdG8gdGhlIHVzZXJcclxuICAgIGNvbnN0IG9yZGVyQ2hlY2sgPSBhd2FpdCBxdWVyeSgnU0VMRUNUIGlkIEZST00gb3JkZXJzIFdIRVJFIGlkID0gPyBBTkQgdXNlcl9pZCA9ID8nLCBbb3JkZXJJZCwgdXNlcklkXSk7XHJcbiAgICBpZiAob3JkZXJDaGVjay5sZW5ndGggPT09IDApIHtcclxuICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoNDAzKS5qc29uKHsgZXJyb3I6ICdVbmF1dGhvcml6ZWQgdG8gcmF0ZSB0aGlzIG9yZGVyJyB9KTtcclxuICAgIH1cclxuICAgIC8vIFN0YXJ0IGEgdHJhbnNhY3Rpb25cclxuICAgIGF3YWl0IHF1ZXJ5KCdTVEFSVCBUUkFOU0FDVElPTicpO1xyXG4gICAgdHJ5IHtcclxuICAgICAgLy8gSW5zZXJ0IHJhdGluZ3MgZm9yIGVhY2ggcHJvZHVjdFxyXG4gICAgICBmb3IgKGNvbnN0IFtwcm9kdWN0SWQsIHJhdGluZ10gb2YgT2JqZWN0LmVudHJpZXMocmF0aW5ncykpIHtcclxuICAgICAgICBhd2FpdCBxdWVyeSgnSU5TRVJUIElOVE8gcHJvZHVjdF9yYXRpbmdzIChvcmRlcl9pZCwgcHJvZHVjdF9pZCwgcmF0aW5nKSBWQUxVRVMgKD8sID8sID8pJywgW29yZGVySWQsIHByb2R1Y3RJZCwgcmF0aW5nXSk7XHJcbiAgICAgIH1cclxuICAgICAgLy8gSW5zZXJ0IGZlZWRiYWNrXHJcbiAgICAgIGlmIChmZWVkYmFjaykge1xyXG4gICAgICAgIGF3YWl0IHF1ZXJ5KCdJTlNFUlQgSU5UTyBvcmRlcl9mZWVkYmFjayAob3JkZXJfaWQsIGZlZWRiYWNrKSBWQUxVRVMgKD8sID8pJywgW29yZGVySWQsIGZlZWRiYWNrXSk7XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIC8vIFVwZGF0ZSB0aGUgb3JkZXIgdG8gbWFyayBpdCBhcyByYXRlZFxyXG4gICAgICBhd2FpdCBxdWVyeSgnVVBEQVRFIG9yZGVycyBTRVQgaXNfcmF0ZWQgPSAxIFdIRVJFIGlkID0gPycsIFtvcmRlcklkXSk7XHJcblxyXG4gICAgICAvLyBDb21taXQgdGhlIHRyYW5zYWN0aW9uXHJcbiAgICAgIGF3YWl0IHF1ZXJ5KCdDT01NSVQnKTtcclxuXHJcbiAgICAgIHJlcy5zdGF0dXMoMjAwKS5qc29uKHsgc3VjY2VzczogdHJ1ZSwgbWVzc2FnZTogJ1JhdGluZ3Mgc3VibWl0dGVkIHN1Y2Nlc3NmdWxseScgfSk7XHJcbiAgICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgICAvLyBJZiB0aGVyZSdzIGFuIGVycm9yLCByb2xsYmFjayB0aGUgdHJhbnNhY3Rpb25cclxuICAgICAgYXdhaXQgcXVlcnkoJ1JPTExCQUNLJyk7XHJcbiAgICAgIHRocm93IGVycm9yO1xyXG4gICAgfVxyXG4gIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICBpZiAoZXJyb3IubmFtZSA9PT0gJ0pzb25XZWJUb2tlbkVycm9yJykge1xyXG4gICAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDEpLmpzb24oeyBlcnJvcjogJ0ludmFsaWQgdG9rZW4nIH0pO1xyXG4gICAgfVxyXG4gICAgY29uc29sZS5lcnJvcignRXJyb3Igc3VibWl0dGluZyByYXRpbmdzOicsIGVycm9yKTtcclxuICAgIHJlcy5zdGF0dXMoNTAwKS5qc29uKHsgZXJyb3I6ICdBbiBlcnJvciBvY2N1cnJlZCB3aGlsZSBzdWJtaXR0aW5nIHJhdGluZ3MnLCBkZXRhaWxzOiBlcnJvci5tZXNzYWdlIH0pO1xyXG4gIH1cclxufVxyXG4gIFxyXG4gIFxyXG4gIFxyXG4gIFxyXG4gIFxyXG4gXHJcbiAgXHJcblxyXG4gIGV4cG9ydCBkZWZhdWx0IHdpdGhJcm9uU2Vzc2lvbihoYW5kbGVyLCB7XHJcbiAgICBwYXNzd29yZDogcHJvY2Vzcy5lbnYuU0VTU0lPTl9QQVNTV09SRCxcclxuICAgIGNvb2tpZU5hbWU6ICduYXJzX3Nlc3Npb24nLFxyXG4gICAgY29va2llT3B0aW9uczoge1xyXG4gICAgICBzZWN1cmU6IHByb2Nlc3MuZW52Lk5PREVfRU5WID09PSAncHJvZHVjdGlvbicsXHJcbiAgICAgIHNhbWVTaXRlOiAnc3RyaWN0JyxcclxuICAgICAgaHR0cE9ubHk6IHRydWUsXHJcbiAgICB9LFxyXG4gIH0pOyJdLCJuYW1lcyI6WyJwYXJzZSIsImJjcnlwdCIsInNpZ24iLCJ2ZXJpZnkiLCJxdWVyeSIsImNyeXB0byIsIndpdGhJcm9uU2Vzc2lvbiIsImhhbmRsZXIiLCJyZXEiLCJyZXMiLCJtZXRob2QiLCJwYXRobmFtZSIsInVybCIsImhhbmRsZUNoZWNrQXV0aCIsInN0YXJ0c1dpdGgiLCJoYW5kbGVHZXRPcmRlciIsImhhbmRsZU9yZGVyVHJhY2tpbmciLCJoYW5kbGVPcmRlckhpc3RvcnkiLCJoYW5kbGVBbGxPcmRlcnMiLCJoYW5kbGVMb2dvdXQiLCJoYW5kbGVHZXRVc2VyIiwiaGFuZGxlR2V0UHJvZHVjdHMiLCJjYXRlZ29yeSIsInNwbGl0IiwicG9wIiwiaGFuZGxlR2V0UHJvZHVjdHNCeUNhdGVnb3J5IiwiaGFuZGxlR2V0Q2FydCIsImhhbmRsZUdldExpbWl0ZWRJdGVtcyIsImhhbmRsZUdldENhdGVnb3JpZXMiLCJoYW5kbGVTZWFyY2giLCJzdGF0dXMiLCJqc29uIiwiZXJyb3IiLCJoYW5kbGVTaWdudXAiLCJoYW5kbGVTaWduaW4iLCJoYW5kbGVQbGFjZU9yZGVyIiwiaGFuZGxlQ2FuY2VsT3JkZXIiLCJoYW5kbGVTdWJtaXRSYXRpbmdzIiwiaGFuZGxlQWRkVG9DYXJ0IiwiaGFuZGxlVXBkYXRlQ2FydCIsImhhbmRsZVJlbW92ZUZyb21DYXJ0Iiwic2V0SGVhZGVyIiwiZW5kIiwiY29uc29sZSIsImZpcnN0bmFtZSIsImxhc3RuYW1lIiwiYWRkcmVzcyIsIm1vYmlsZSIsImVtYWlsIiwicGFzc3dvcmQiLCJib2R5IiwiZXhpc3RpbmdVc2VyIiwibGVuZ3RoIiwiaGFzaGVkUGFzc3dvcmQiLCJoYXNoIiwicmVzdWx0IiwidG9rZW4iLCJ1c2VySWQiLCJpbnNlcnRJZCIsInByb2Nlc3MiLCJlbnYiLCJKV1RfU0VDUkVUIiwiZXhwaXJlc0luIiwibWVzc2FnZSIsInVzZXJzIiwic3VjY2VzcyIsInVzZXIiLCJtYXRjaCIsImNvbXBhcmUiLCJpZCIsInNlc3Npb24iLCJmaXJzdE5hbWUiLCJzYXZlIiwibG9naW5UaW1lIiwiRGF0ZSIsImhlYWRlcnMiLCJhdXRob3JpemF0aW9uIiwiaXNBdXRoZW50aWNhdGVkIiwiZGVjb2RlZCIsImF1dGhIZWFkZXIiLCJsb2ciLCJ0aGVuIiwiY2F0Y2giLCJuYW1lIiwiY29kZSIsInVzZXJFbWFpbCIsImxvZ291dFRpbWUiLCJhZmZlY3RlZFJvd3MiLCJkYkVycm9yIiwic2VhcmNoUXVlcnkiLCJzZWFyY2hUZXJtcyIsIm1hcCIsInRlcm0iLCJwbGFjZWhvbGRlcnMiLCJqb2luIiwic3FsIiwicGFyYW1zIiwiZmxhdE1hcCIsInJlc3VsdHMiLCJkZXRhaWxzIiwicHJvZHVjdHNRdWVyeSIsInByb2R1Y3RzIiwiZGVjb2RlZENhdGVnb3J5IiwiZGVjb2RlVVJJQ29tcG9uZW50Iiwic3RhY2siLCJsaW1pdGVkSXRlbXNRdWVyeSIsImxpbWl0ZWRJdGVtcyIsImNhdGVnb3JpZXMiLCJmb3JtYXR0ZWRDYXRlZ29yaWVzIiwiaXRlbSIsImJpbGxpbmdJbmZvIiwicGF5bWVudE1ldGhvZCIsImNhcnRJdGVtcyIsInN1YnRvdGFsIiwiZGVsaXZlcnkiLCJ0b3RhbCIsInRyYWNraW5nTnVtYmVyIiwicmFuZG9tQnl0ZXMiLCJ0b1N0cmluZyIsInRvVXBwZXJDYXNlIiwib3JkZXJSZXN1bHQiLCJmdWxsTmFtZSIsInBob25lTnVtYmVyIiwiY2l0eSIsInN0YXRlUHJvdmluY2UiLCJwb3N0YWxDb2RlIiwiZGVsaXZlcnlBZGRyZXNzIiwib3JkZXJJZCIsInN0b2NrUmVjb3JkIiwicXVhbnRpdHkiLCJwcmljZSIsInVwZGF0ZVJlc3VsdCIsIm9yZGVyRGV0YWlscyIsInRyYWNraW5nX251bWJlciIsImZ1bGxfbmFtZSIsInBob25lX251bWJlciIsInN0YXRlX3Byb3ZpbmNlIiwicG9zdGFsX2NvZGUiLCJkZWxpdmVyeV9hZGRyZXNzIiwicGF5bWVudF9tZXRob2QiLCJpdGVtcyIsInByb2R1Y3RfaWQiLCJpbWFnZVVybCIsImltYWdlX3VybCIsImRlbGl2ZXJ5X2ZlZSIsIm9yZGVycyIsInJhdGluZ3MiLCJmZWVkYmFjayIsIm9yZGVyQ2hlY2siLCJwcm9kdWN0SWQiLCJyYXRpbmciLCJPYmplY3QiLCJlbnRyaWVzIiwiU0VTU0lPTl9QQVNTV09SRCIsImNvb2tpZU5hbWUiLCJjb29raWVPcHRpb25zIiwic2VjdXJlIiwic2FtZVNpdGUiLCJodHRwT25seSJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(api)/./src/pages/api/[...narsapi].js\n");

/***/ }),

/***/ "(api)/./src/utils/db.js":
/*!*************************!*\
  !*** ./src/utils/db.js ***!
  \*************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__),\n/* harmony export */   query: () => (/* binding */ query)\n/* harmony export */ });\n/* harmony import */ var mysql2_promise__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! mysql2/promise */ \"mysql2/promise\");\n/* harmony import */ var mysql2_promise__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(mysql2_promise__WEBPACK_IMPORTED_MODULE_0__);\n\nconst pool = mysql2_promise__WEBPACK_IMPORTED_MODULE_0___default().createPool({\n    host: process.env.MYSQL_HOST,\n    port: parseInt(process.env.MYSQL_PORT),\n    database: process.env.MYSQL_DATABASE,\n    user: process.env.MYSQL_USER,\n    password: process.env.MYSQL_PASSWORD,\n    connectionLimit: 10,\n    waitForConnections: true,\n    queueLimit: 0\n});\nasync function query(sql, values) {\n    try {\n        const [results] = await pool.query(sql, values);\n        return results;\n    } catch (error) {\n        console.error(\"Database query error:\", error);\n        throw error;\n    }\n}\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (pool);\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaSkvLi9zcmMvdXRpbHMvZGIuanMiLCJtYXBwaW5ncyI6Ijs7Ozs7OztBQUFtQztBQUVuQyxNQUFNQyxPQUFPRCxnRUFBZ0IsQ0FBQztJQUM1QkcsTUFBTUMsUUFBUUMsR0FBRyxDQUFDQyxVQUFVO0lBQzVCQyxNQUFNQyxTQUFTSixRQUFRQyxHQUFHLENBQUNJLFVBQVU7SUFDckNDLFVBQVVOLFFBQVFDLEdBQUcsQ0FBQ00sY0FBYztJQUNwQ0MsTUFBTVIsUUFBUUMsR0FBRyxDQUFDUSxVQUFVO0lBQzVCQyxVQUFVVixRQUFRQyxHQUFHLENBQUNVLGNBQWM7SUFDcENDLGlCQUFpQjtJQUNqQkMsb0JBQW9CO0lBQ3BCQyxZQUFZO0FBQ2Q7QUFFTyxlQUFlQyxNQUFNQyxHQUFHLEVBQUVDLE1BQU07SUFDckMsSUFBSTtRQUNGLE1BQU0sQ0FBQ0MsUUFBUSxHQUFHLE1BQU1yQixLQUFLa0IsS0FBSyxDQUFDQyxLQUFLQztRQUN4QyxPQUFPQztJQUNULEVBQUUsT0FBT0MsT0FBTztRQUNkQyxRQUFRRCxLQUFLLENBQUMseUJBQXlCQTtRQUN2QyxNQUFNQTtJQUNSO0FBQ0Y7QUFFQSxpRUFBZXRCLElBQUlBLEVBQUMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9uYXJzLy4vc3JjL3V0aWxzL2RiLmpzP2QzODQiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IG15c3FsIGZyb20gJ215c3FsMi9wcm9taXNlJztcclxuXHJcbmNvbnN0IHBvb2wgPSBteXNxbC5jcmVhdGVQb29sKHtcclxuICBob3N0OiBwcm9jZXNzLmVudi5NWVNRTF9IT1NULFxyXG4gIHBvcnQ6IHBhcnNlSW50KHByb2Nlc3MuZW52Lk1ZU1FMX1BPUlQpLFxyXG4gIGRhdGFiYXNlOiBwcm9jZXNzLmVudi5NWVNRTF9EQVRBQkFTRSxcclxuICB1c2VyOiBwcm9jZXNzLmVudi5NWVNRTF9VU0VSLFxyXG4gIHBhc3N3b3JkOiBwcm9jZXNzLmVudi5NWVNRTF9QQVNTV09SRCxcclxuICBjb25uZWN0aW9uTGltaXQ6IDEwLFxyXG4gIHdhaXRGb3JDb25uZWN0aW9uczogdHJ1ZSxcclxuICBxdWV1ZUxpbWl0OiAwXHJcbn0pO1xyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHF1ZXJ5KHNxbCwgdmFsdWVzKSB7XHJcbiAgdHJ5IHtcclxuICAgIGNvbnN0IFtyZXN1bHRzXSA9IGF3YWl0IHBvb2wucXVlcnkoc3FsLCB2YWx1ZXMpO1xyXG4gICAgcmV0dXJuIHJlc3VsdHM7XHJcbiAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgIGNvbnNvbGUuZXJyb3IoJ0RhdGFiYXNlIHF1ZXJ5IGVycm9yOicsIGVycm9yKTtcclxuICAgIHRocm93IGVycm9yO1xyXG4gIH1cclxufVxyXG5cclxuZXhwb3J0IGRlZmF1bHQgcG9vbDsiXSwibmFtZXMiOlsibXlzcWwiLCJwb29sIiwiY3JlYXRlUG9vbCIsImhvc3QiLCJwcm9jZXNzIiwiZW52IiwiTVlTUUxfSE9TVCIsInBvcnQiLCJwYXJzZUludCIsIk1ZU1FMX1BPUlQiLCJkYXRhYmFzZSIsIk1ZU1FMX0RBVEFCQVNFIiwidXNlciIsIk1ZU1FMX1VTRVIiLCJwYXNzd29yZCIsIk1ZU1FMX1BBU1NXT1JEIiwiY29ubmVjdGlvbkxpbWl0Iiwid2FpdEZvckNvbm5lY3Rpb25zIiwicXVldWVMaW1pdCIsInF1ZXJ5Iiwic3FsIiwidmFsdWVzIiwicmVzdWx0cyIsImVycm9yIiwiY29uc29sZSJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(api)/./src/utils/db.js\n");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../webpack-api-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/next"], () => (__webpack_exec__("(api)/./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2F%5B...narsapi%5D&preferredRegion=&absolutePagePath=.%2Fsrc%5Cpages%5Capi%5C%5B...narsapi%5D.js&middlewareConfigBase64=e30%3D!")));
module.exports = __webpack_exports__;

})();